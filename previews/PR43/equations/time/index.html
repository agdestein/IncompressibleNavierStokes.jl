<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time discretization · IncompressibleNavierStokes.jl</title><meta name="title" content="Time discretization · IncompressibleNavierStokes.jl"/><meta property="og:title" content="Time discretization · IncompressibleNavierStokes.jl"/><meta property="twitter:title" content="Time discretization · IncompressibleNavierStokes.jl"/><meta name="description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="twitter:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/time/"/><meta property="twitter:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/time/"/><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/time/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Tutorial: Lid-Driven Cavity (2D)</a></li><li><a class="tocitem" href="../../generated/TaylorGreenVortex2D/">Convergence: Taylor-Green Vortex (2D)</a></li><li><a class="tocitem" href="../../generated/Actuator2D/">Unsteady inflow: Actuator (2D)</a></li><li><a class="tocitem" href="../../generated/BackwardFacingStep2D/">Walls: Backward Facing Step (2D)</a></li><li><a class="tocitem" href="../../generated/DecayingTurbulence2D/">Decaying Turbulunce (2D)</a></li><li><a class="tocitem" href="../../generated/PlanarMixing2D/">Planar Mixing (2D)</a></li></ul></li><li><span class="tocitem">Equations</span><ul><li><a class="tocitem" href="../ns/">Incompressible Navier-Stokes equations</a></li><li><a class="tocitem" href="../spatial/">Spatial discretization</a></li><li class="is-active"><a class="tocitem" href>Time discretization</a><ul class="internal"><li><a class="tocitem" href="#Explicit-Runge-Kutta-methods"><span>Explicit Runge-Kutta methods</span></a></li><li><a class="tocitem" href="#Implicit-Runge-Kutta-methods"><span>Implicit Runge-Kutta methods</span></a></li><li><a class="tocitem" href="#Adams-Bashforth-Crank-Nicolson-method"><span>Adams-Bashforth Crank-Nicolson method</span></a></li><li><a class="tocitem" href="#One-leg-beta-method"><span>One-leg beta method</span></a></li></ul></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../../features/bc/">Boundary conditions</a></li><li><a class="tocitem" href="../../features/pressure/">Pressure solvers</a></li><li><a class="tocitem" href="../../features/precision/">Floating point precision</a></li><li><a class="tocitem" href="../../features/gpu/">GPU Support</a></li><li><a class="tocitem" href="../../features/operators/">Operators</a></li><li><a class="tocitem" href="../../features/les/">Large eddy simulation</a></li><li><a class="tocitem" href="../../features/closure/">Neural closure models</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/api/">API</a></li><li><a class="tocitem" href="../../api/tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Equations</a></li><li class="is-active"><a href>Time discretization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time discretization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/equations/time.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-discretization"><a class="docs-heading-anchor" href="#Time-discretization">Time discretization</a><a id="Time-discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Time-discretization" title="Permalink"></a></h1><p>The spatially discretized Navier-Stokes equations form a differential-algebraic system, with an ODE for the velocity</p><p class="math-container">\[\frac{\mathrm{d} u}{\mathrm{d} t} = F(u, t) - (G p + y_G)\]</p><p>subject to the algebraic constraint formed by the mass equation</p><p class="math-container">\[M u + y_M = 0.\]</p><p>In the end of the <a href="../spatial/">previous section</a>, we differentiated the mass equation in time to obtain a discrete pressure Poisson equation. This equation includes the term <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}$</span>, which is non-zero if an unsteady flow of mass is added to the domain (Dirichlet boundary conditions). This term ensures that the time-continuous discrete velocity field <span>$u(t)$</span> stays divergence free (conserves mass). However, if we directly discretize this system in time, the mass preservation may actually not be respected. For this, we will change the definition of the pressure such that the time-discretized velocity field is divergence free at each time step and each time sub-step (to be defined in the following).</p><p>Consider the interval <span>$[0, T]$</span> for some simulation time <span>$T$</span>. We will divide it into <span>$N$</span> sub-intervals <span>$[t^n, t^{n + 1}]$</span> for <span>$n = 0, \dots, N - 1$</span>, with <span>$t^0 = 0$</span>, <span>$t^N = T$</span>, and increment <span>$\Delta t^n = t^{n + 1} - t^n$</span>. We define <span>$u^n \approx u(t^n)$</span> as an approximation to the exact discrete velocity field <span>$u(t^n)$</span>, with <span>$u^0 = u(0)$</span> starting from the exact initial conditions. We say that the time integration scheme (definition of <span>$u^n$</span>) is accurate to the order <span>$r$</span> if <span>$u^n = u(t^n) + \mathcal{O}(\Delta t^r)$</span> for all <span>$n$</span>.</p><p>IncompressibleNavierStokes provides a collection of explicit and implicit <a href="../../api/tableaux/">Runge-Kutta methods</a>, in addition to Adams-Bashforth Crank-Nicolson and one-leg beta method time steppers.</p><p>The code is currently not adapted to time steppers from <a href="https://docs.sciml.ai/DiffEqDocs/stable/solvers/dae_solve/">DifferentialEquations.jl</a>, but they may be integrated in the future.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractODEMethod" href="#IncompressibleNavierStokes.AbstractODEMethod"><code>IncompressibleNavierStokes.AbstractODEMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractODEMethod</code></pre><p>Abstract ODE method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractRungeKuttaMethod" href="#IncompressibleNavierStokes.AbstractRungeKuttaMethod"><code>IncompressibleNavierStokes.AbstractRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractRungeKuttaMethod</code></pre><p>Abstract Runge Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.isexplicit" href="#IncompressibleNavierStokes.isexplicit"><code>IncompressibleNavierStokes.isexplicit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">isexplicit(method)</code></pre><p>Return <code>true</code> if <code>method</code> is explicit, i.e. the value at a certain time step is given explicitly as a function of the previous time steps only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/isexplicit.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.lambda_conv_max" href="#IncompressibleNavierStokes.lambda_conv_max"><code>IncompressibleNavierStokes.lambda_conv_max</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lambda_conv_max(method)</code></pre><p>Get maximum value of stability region for the convection operator (not a very good indication for the methods that do not include the imaginary axis)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/lambda_max.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.lambda_diff_max" href="#IncompressibleNavierStokes.lambda_diff_max"><code>IncompressibleNavierStokes.lambda_diff_max</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lambda_diff_max(method)</code></pre><p>Get maximum value of stability region for the diffusion operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/lambda_max.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.ode_method_cache" href="#IncompressibleNavierStokes.ode_method_cache"><code>IncompressibleNavierStokes.ode_method_cache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ode_method_cache(method, setup)</code></pre><p>Get time stepper cache for the given ODE method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/time_stepper_caches.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.nstage" href="#IncompressibleNavierStokes.nstage"><code>IncompressibleNavierStokes.nstage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nstage(rk_method)</code></pre><p>Get number of stages of the Runge-Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/nstage.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.runge_kutta_method" href="#IncompressibleNavierStokes.runge_kutta_method"><code>IncompressibleNavierStokes.runge_kutta_method</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">runge_kutta_method(A, b, c, r; [p_add_solve], [newton_type], [maxiter], [abstol], [reltol])</code></pre><p>Get Runge Kutta method. The function checks whether the method is explicit.</p><p><code>p_add_solve</code>: whether to add a pressure solve step to the method.</p><p>For implicit RK methods: <code>newton_type</code>, <code>maxiter</code>, <code>abstol</code>, <code>reltol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L122-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.timestep" href="#IncompressibleNavierStokes.timestep"><code>IncompressibleNavierStokes.timestep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step(stepper, Δt; bc_vectors = nothing)</code></pre><p>Perform one time step.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.timestep!"><code>timestep!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/step.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.timestep!" href="#IncompressibleNavierStokes.timestep!"><code>IncompressibleNavierStokes.timestep!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step!(stepper, Δt; cache, momentum_cache, bc_vectors = nothing)</code></pre><p>Perform one time step&gt;</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.timestep"><code>timestep</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/step.jl#L13-L21">source</a></section></article><h2 id="Explicit-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Explicit-Runge-Kutta-methods">Explicit Runge-Kutta methods</a><a id="Explicit-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-Runge-Kutta-methods" title="Permalink"></a></h2><p>See Sanderse [<a href="../../references/#Sanderse2012">5</a>].</p><p>Consider the velocity field <span>$u_0$</span> at a certain time <span>$t_0$</span>. We will now perform one time step to <span>$t = t_0 + \Delta t$</span>. For explicit Runge-Kutta methods, this time step is divided into <span>$s$</span> sub-steps <span>$t_i = t_0 + \Delta t_i$</span> with increment <span>$\Delta t_i = c_i \Delta t$</span>. The final substep performs the full time step <span>$\Delta t_s = \Delta t$</span> such that <span>$t_s = t$</span>.</p><p>For <span>$i = 1, \dots, s$</span>, the intermediate velocity <span>$u_i$</span> and pressure <span>$p_i$</span> are computed as follows:</p><p class="math-container">\[\begin{split}
k_i &amp; = F(u_{i - 1}, t_{i - 1}) - y_G(t_{i - 1}) \\
v_i &amp; = u_0 + \Delta t \sum_{j = 1}^i a_{i j} k_j \\
L p_i &amp; = W M \frac{1}{c_i} \sum_{j = 1}^i a_{i j} k_j +
W \frac{y_M(t_i) - y_M(t_0)}{\Delta t_i} \\
&amp; = W \frac{(M v_i + y_M(t_i)) - (M u_0 + y_M(t_0))}{\Delta t_i^n} \\
&amp; = W \frac{M v_i + y_M(t_i)}{\Delta t_i^n} \\
u_i &amp; = v_i - \Delta t_i G p_i,
\end{split}\]</p><p>where <span>$(a_{i j})_{i j}$</span> are the Butcher tableau coefficients of the RK-method, with the convention <span>$c_i = \sum_{j = 1}^i a_{i j}$</span>.</p><p>Finally, we return <span>$u_s$</span>. If <span>$u_0 = u(t_0)$</span>, we get the accuracy <span>$u_s = u(t) + \mathcal{O}(\Delta t^{r + 1})$</span>, where <span>$r$</span> is the order of the RK-method. If we perform <span>$n$</span> RK time steps instead of one, starting at exact initial conditions <span>$u^0 = u(0)$</span>, then <span>$u^n = u(t^n) + \mathcal{O}(\Delta t^r)$</span> for all <span>$n \in \{1, \dots, N\}$</span>. Note that for a given <span>$u$</span>, the corresponding pressure <span>$p$</span> can be calculated to the same accuracy as <span>$u$</span> by doing an additional pressure projection after each outer time step <span>$\Delta t$</span> (if we know <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}(t)$</span>), or to first order accuracy by simply returning <span>$p_s$</span>.</p><p>Note that each of the sub-step velocities <span>$u_i$</span> is divergence free, after projecting the tentative velocities <span>$v_i$</span>. This is ensured due to the judiciously chosen replacement of <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}(t_i)$</span> with <span>$(y_M(t_i) - y_M(t_0)) / \Delta t_i$</span>. The space-discrete divergence-freeness is thus perfectly preserved, even though the time discretization introduces other errors.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.ExplicitRungeKuttaMethod" href="#IncompressibleNavierStokes.ExplicitRungeKuttaMethod"><code>IncompressibleNavierStokes.ExplicitRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExplicitRungeKuttaMethod(; A, b, c, r, p_add_solve = true)</code></pre><p>Explicit Runge Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L75-L79">source</a></section></article><h2 id="Implicit-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Implicit-Runge-Kutta-methods">Implicit Runge-Kutta methods</a><a id="Implicit-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Runge-Kutta-methods" title="Permalink"></a></h2><p>See Sanderse [<a href="../../references/#Sanderse2013">6</a>].</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.ImplicitRungeKuttaMethod" href="#IncompressibleNavierStokes.ImplicitRungeKuttaMethod"><code>IncompressibleNavierStokes.ImplicitRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ImplicitRungeKuttaMethod(;
    A,
    b,
    c,
    r,
    newton_type = :full,
    maxiter = 10,
    abstol = 1e-14,
    reltol = 1e-14,
    p_add_solve = true,
)</code></pre><p>Implicit Runge Kutta method.</p><p>The implicit linear system is solved at each time step using Newton&#39;s method. The <code>newton_type</code> may be one of the following:</p><ul><li><code>:no</code>: Replace iteration matrix with I/Δt (no Jacobian)</li><li><code>:approximate</code>: Build Jacobian once before iterations only</li><li><code>:full</code>: Build Jacobian at each iteration</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L88-L109">source</a></section></article><h2 id="Adams-Bashforth-Crank-Nicolson-method"><a class="docs-heading-anchor" href="#Adams-Bashforth-Crank-Nicolson-method">Adams-Bashforth Crank-Nicolson method</a><a id="Adams-Bashforth-Crank-Nicolson-method-1"></a><a class="docs-heading-anchor-permalink" href="#Adams-Bashforth-Crank-Nicolson-method" title="Permalink"></a></h2><p>We here require that the time step <span>$\Delta t$</span> is constant. This methods uses Adams-Bashforth for the convective terms and Crank-Nicolson stepping for the diffusion and body force terms. Given the velocity field <span>$u_0 = u(t_0)$</span> at a time <span>$t_0$</span> and its previous value <span>$u_{-1} = u(t_0 - \Delta t)$</span> at the previous time <span>$t_{-1} = t_0 - \Delta t$</span>, the predicted velocity field <span>$u$</span> at the time <span>$t = t_0 + \Delta t$</span> is defined by first computing a tentative velocity:</p><p class="math-container">\[\begin{split}
\frac{v - u_0}{\Delta t}
&amp; = - (\alpha_0 C(u_0, t_0) + \alpha_{-1} C(u_{-1}, t_{-1})) \\
&amp; + \theta (D u_0 + y_D(t_0)) + (1 - \theta) (D v + y_D(t)) \\
&amp; + \theta f(t_0) + (1 - \theta) f(t) \\
&amp; - (G p_0 + y_G(t_0)),
\end{split}\]</p><p>where <span>$\theta \in [0, 1]$</span> is the Crank-Nicolson parameter (<span>$\theta = \frac{1}{2}$</span> for second order convergence), <span>$(\alpha_0, \alpha_{-1}) = \left( \frac{3}{2}, -\frac{1}{2} \right)$</span> are the Adams-Bashforth coefficients, and <span>$v$</span> is a tentative velocity yet to be made divergence free. We can group the terms containing <span>$v$</span> on the left hand side, to obtain</p><p class="math-container">\[\begin{split}
\left( \frac{1}{\Delta t} I - (1 - \theta) D \right) v
&amp; = \left(\frac{1}{\Delta t} I - \theta D \right) u_0 \\
&amp; - (\alpha_0 C(u_0, t_0) + \alpha_{-1} C(u_{-1}, t_{-1})) \\
&amp; + \theta y_D(t_0) + (1 - \theta) y_D(t) \\
&amp; + \theta f(t_0) + (1 - \theta) f(t) \\
&amp; - (G p_0 + y_G(t_0)).
\end{split}\]</p><p>We can compute <span>$v$</span> by inverting the positive definite matrix <span>$\left( \frac{1}{\Delta t} I - \theta D \right)$</span> for the given right hand side using a suitable linear solver. Assuming <span>$\Delta t$</span> is constant, we can precompute a Cholesky factorization of this matrix before starting time stepping.</p><p>We then compute the pressure difference <span>$\Delta p$</span> by solving</p><p class="math-container">\[L \Delta p = W \frac{M v + y_M(t)}{\Delta t} - W M (y_G(t) - y_G(t_0)),\]</p><p>after which a divergence free velocity <span>$u$</span> can be enforced:</p><p class="math-container">\[u = v - \Delta t (G \Delta p + y_G(t) - y_G(t_0)).\]</p><p>A first order accurate prediction of the corresponding pressure is <span>$p = p_0 + \Delta p$</span>. However, since this pressure is reused in the next time step, we perform an additional pressure solve to avoid accumulating first order errors. The resulting pressure <span>$p$</span> is then accurate to the same order as <span>$u$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod" href="#IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod"><code>IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AdamsBashforthCrankNicolsonMethod(
    T = Float64;
    α₁ = T(3 // 2),
    α₂ = T(-1 // 2),
    θ = T(1 // 2),
    p_add_solve = true,
    method_startup = RK44(; T),
)</code></pre><p>IMEX AB-CN: Adams-Bashforth for explicit convection (parameters <code>α₁</code> and <code>α₂</code>) and Crank-Nicolson for implicit diffusion (implicitness <code>θ</code>). The method is second order for <code>θ = 1/2</code>.</p><p>The LU decomposition of the LHS matrix is computed every time the time step changes.</p><p>Note that, in contrast to explicit methods, the pressure from previous time steps has an influence on the accuracy of the velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L8-L27">source</a></section></article><h2 id="One-leg-beta-method"><a class="docs-heading-anchor" href="#One-leg-beta-method">One-leg beta method</a><a id="One-leg-beta-method-1"></a><a class="docs-heading-anchor-permalink" href="#One-leg-beta-method" title="Permalink"></a></h2><p>See Verstappen and Veldman [<a href="../../references/#Verstappen2003">8</a>] [<a href="../../references/#Verstappen1997">9</a>].</p><p>We here require that the time step <span>$\Delta t$</span> is constant. Given the velocity <span>$u_0$</span> and pressure <span>$p_0$</span> at the current time <span>$t_0$</span> and their previous values <span>$u_{-1}$</span> and <span>$p_{-1}$</span> at the time <span>$t_{-1} = t_0 - \Delta t$</span>, we start by computing the &quot;offstep&quot; values <span>$v = (1 + \beta) v_0 - \beta v_{-1}$</span> and <span>$Q = (1 + \beta) p_0 - \beta p_{-1}$</span> for some <span>$\beta = \frac{1}{2}$</span>.</p><p>A tentative velocity field <span>$\tilde{v}$</span> is then computed as follows:</p><p class="math-container">\[\tilde{v} = \frac{1}{\beta + \frac{1}{2}} \left( 2 \beta u_0 - \left( \beta -
\frac{1}{2} \right) u_{-1} + \Delta t F(v, t) - \Delta t
(G Q + y_G(t)) \right).\]</p><p>A pressure correction <span>$\Delta p$</span> is obtained by solving the Poisson equation</p><p class="math-container">\[L \Delta p = \frac{\beta + \frac{1}{2}}{\Delta t} W (M \tilde{v} + y_M(t)).\]</p><p>Finally, the divergence free velocity field is given by</p><p class="math-container">\[u = \tilde{v} - \frac{\Delta t}{\beta + \frac{1}{2}} G \Delta p,\]</p><p>while the second order accurate pressure is given by</p><p class="math-container">\[p = 2 p_0 - p_{-1} + \frac{4}{3} \Delta p.\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.OneLegMethod" href="#IncompressibleNavierStokes.OneLegMethod"><code>IncompressibleNavierStokes.OneLegMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OneLegMethod(
    T = Float64;
    β = T(1 // 2),
    p_add_solve = true,
    method_startup = RK44(; T),
)</code></pre><p>Explicit one-leg β-method following symmetry-preserving discretization of turbulent flow. See Verstappen and Veldman [<a href="../../references/#Verstappen2003">8</a>] [<a href="../../references/#Verstappen1997">9</a>] for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/387501caf093f6eab4c31b64830baaa7628a313e/src/time_steppers/methods.jl#L44-L55">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spatial/">« Spatial discretization</a><a class="docs-footer-nextpage" href="../../features/bc/">Boundary conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Thursday 25 April 2024 15:13">Thursday 25 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
