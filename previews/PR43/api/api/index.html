<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · IncompressibleNavierStokes.jl</title><meta name="title" content="API · IncompressibleNavierStokes.jl"/><meta property="og:title" content="API · IncompressibleNavierStokes.jl"/><meta property="twitter:title" content="API · IncompressibleNavierStokes.jl"/><meta name="description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="twitter:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><meta property="twitter:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Tutorial: Lid-Driven Cavity (2D)</a></li></ul></li><li><span class="tocitem">Equations</span><ul><li><a class="tocitem" href="../../equations/ns/">Incompressible Navier-Stokes equations</a></li><li><a class="tocitem" href="../../equations/spatial/">Spatial discretization</a></li><li><a class="tocitem" href="../../equations/time/">Time discretization</a></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../../features/precision/">Floating point precision</a></li><li><a class="tocitem" href="../../features/gpu/">GPU Support</a></li><li><a class="tocitem" href="../../features/les/">Large eddy simulation</a></li><li><a class="tocitem" href="../../features/closure/">Neural closure models</a></li><li><a class="tocitem" href="../../features/pressure/">Pressure solvers</a></li><li><a class="tocitem" href="../../features/bc/">Boundary conditions</a></li><li><a class="tocitem" href="../../features/steppers/">Time steppers</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Grid"><span>Grid</span></a></li><li><a class="tocitem" href="#Visocosity-Models"><span>Visocosity Models</span></a></li><li><a class="tocitem" href="#Convection-Models"><span>Convection Models</span></a></li><li><a class="tocitem" href="#Momentum"><span>Momentum</span></a></li><li><a class="tocitem" href="#Postprocess"><span>Postprocess</span></a></li><li><a class="tocitem" href="#Preprocess"><span>Preprocess</span></a></li><li><a class="tocitem" href="#Processors"><span>Processors</span></a></li><li><a class="tocitem" href="#Solvers"><span>Solvers</span></a></li><li><a class="tocitem" href="#Time-steppers"><span>Time steppers</span></a></li><li><a class="tocitem" href="#Utils"><span>Utils</span></a></li><li><a class="tocitem" href="#Other"><span>Other</span></a></li></ul></li><li><a class="tocitem" href="../tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/api/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.IncompressibleNavierStokes" href="#IncompressibleNavierStokes.IncompressibleNavierStokes"><code>IncompressibleNavierStokes.IncompressibleNavierStokes</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">IncompressibleNavierStokes</code></pre><p>Energy-conserving solvers for the incompressible Navier-Stokes equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/IncompressibleNavierStokes.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Setup" href="#IncompressibleNavierStokes.Setup"><code>IncompressibleNavierStokes.Setup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Setup(
    x...;
    boundary_conditions = ntuple(d -&gt; (PeriodicBC(), PeriodicBC()), length(x)),
    Re = convert(eltype(x[1]), 1_000),
    viscosity_model = LaminarModel(),
    convection_model = NoRegConvectionModel(),
    bodyforce = nothing,
    closure_model = nothing,
    ArrayType = Array,
)</code></pre><p>Create setup.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/setup.jl#L1-L14">source</a></section></article><h2 id="Grid"><a class="docs-heading-anchor" href="#Grid">Grid</a><a id="Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Grid" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Dimension" href="#IncompressibleNavierStokes.Dimension"><code>IncompressibleNavierStokes.Dimension</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dimension(N)</code></pre><p>Represent an <code>N</code>-dimensional space. Returns <code>N</code> when called.</p><pre><code class="language-example hljs">julia&gt; d = Dimension(3)
Dimension{3}()

julia&gt; d()
3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/grid/dimension.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Grid" href="#IncompressibleNavierStokes.Grid"><code>IncompressibleNavierStokes.Grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Grid(x, boundary_conditions)</code></pre><p>Create nonuniform Cartesian box mesh <code>x[1]</code> × ... × <code>x[d]</code> with boundary conditions <code>boundary_conditions</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/grid/grid.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.cosine_grid" href="#IncompressibleNavierStokes.cosine_grid"><code>IncompressibleNavierStokes.cosine_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cosine_grid(a, b, N)</code></pre><p>Create a nonuniform grid of <code>N + 1</code> points from <code>a</code> to <code>b</code> using a cosine profile, i.e.</p><p class="math-container">\[x_i = a + \frac{1}{2} \left( 1 - \cos \left( \pi \frac{i}{n} \right) \right)
(b - a), \quad i = 0, \dots, N\]</p><p>See also <a href="#IncompressibleNavierStokes.stretched_grid"><code>stretched_grid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/grid/cosine_grid.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.max_size" href="#IncompressibleNavierStokes.max_size"><code>IncompressibleNavierStokes.max_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">max_size(grid)</code></pre><p>Get size of the largest grid element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/grid/max_size.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.stretched_grid" href="#IncompressibleNavierStokes.stretched_grid"><code>IncompressibleNavierStokes.stretched_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stretched_grid(a, b, N, s = 1)</code></pre><p>Create a nonuniform grid of <code>N + 1</code> points from <code>a</code> to <code>b</code> with a stretch factor of <code>s</code>. If <code>s = 1</code>, return a uniform spacing from <code>a</code> to <code>b</code>. Otherwise, return a vector <span>$x \in \mathbb{R}^{N + 1}$</span> such that <span>$x_n = a + \sum_{i = 1}^n s^{i - 1} h$</span> for <span>$n = 0, \dots , N$</span>. Setting <span>$x_N = b$</span> then gives <span>$h = (b - a) \frac{1 - s}{1 - s^N}$</span>, resulting in</p><p class="math-container">\[x_n = a + (b - a) \frac{1 - s^n}{1 - s^N}, \quad n = 0, \dots, N.\]</p><p>Note that <code>stretched_grid(a, b, N, s)[n]</code> corresponds to <span>$x_{n - 1}$</span>.</p><p>See also <a href="#IncompressibleNavierStokes.cosine_grid"><code>cosine_grid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/grid/stretched_grid.jl#L1-L17">source</a></section></article><h2 id="Visocosity-Models"><a class="docs-heading-anchor" href="#Visocosity-Models">Visocosity Models</a><a id="Visocosity-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Visocosity-Models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractViscosityModel" href="#IncompressibleNavierStokes.AbstractViscosityModel"><code>IncompressibleNavierStokes.AbstractViscosityModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractViscosityModel</code></pre><p>Abstract viscosity model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/viscosity_models.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.LaminarModel" href="#IncompressibleNavierStokes.LaminarModel"><code>IncompressibleNavierStokes.LaminarModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LaminarModel()</code></pre><p>Laminar model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/viscosity_models.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.MixingLengthModel" href="#IncompressibleNavierStokes.MixingLengthModel"><code>IncompressibleNavierStokes.MixingLengthModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MixingLengthModel()</code></pre><p>Mixing-length model with mixing length <code>lm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/viscosity_models.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.SmagorinskyModel" href="#IncompressibleNavierStokes.SmagorinskyModel"><code>IncompressibleNavierStokes.SmagorinskyModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SmagorinskyModel(C_s = 0.17)</code></pre><p>Smagorinsky-Lilly model with constant <code>C_s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/viscosity_models.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.QRModel" href="#IncompressibleNavierStokes.QRModel"><code>IncompressibleNavierStokes.QRModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">QR(Re)</code></pre><p>QR-model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/viscosity_models.jl#L34-L38">source</a></section></article><h2 id="Convection-Models"><a class="docs-heading-anchor" href="#Convection-Models">Convection Models</a><a id="Convection-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Convection-Models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractConvectionModel" href="#IncompressibleNavierStokes.AbstractConvectionModel"><code>IncompressibleNavierStokes.AbstractConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractConvectionModel</code></pre><p>Abstract convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/convection_models.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.NoRegConvectionModel" href="#IncompressibleNavierStokes.NoRegConvectionModel"><code>IncompressibleNavierStokes.NoRegConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NoRegConvection()</code></pre><p>Unregularized convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/convection_models.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.C2ConvectionModel" href="#IncompressibleNavierStokes.C2ConvectionModel"><code>IncompressibleNavierStokes.C2ConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">C2ConvectionModel()</code></pre><p>C2 regularization convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/convection_models.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.C4ConvectionModel" href="#IncompressibleNavierStokes.C4ConvectionModel"><code>IncompressibleNavierStokes.C4ConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">C4ConvectionModel()</code></pre><p>C4 regularization convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/convection_models.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.LerayConvectionModel" href="#IncompressibleNavierStokes.LerayConvectionModel"><code>IncompressibleNavierStokes.LerayConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LerayConvectionModel()</code></pre><p>Leray regularization convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/models/convection_models.jl#L29-L33">source</a></section></article><h2 id="Momentum"><a class="docs-heading-anchor" href="#Momentum">Momentum</a><a id="Momentum-1"></a><a class="docs-heading-anchor-permalink" href="#Momentum" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.divergence" href="#IncompressibleNavierStokes.divergence"><code>IncompressibleNavierStokes.divergence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divergence(u, setup)</code></pre><p>Compute divergence of velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.divergence!" href="#IncompressibleNavierStokes.divergence!"><code>IncompressibleNavierStokes.divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divergence!(M, u, setup)</code></pre><p>Compute divergence of velocity field (in-place version).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.vorticity" href="#IncompressibleNavierStokes.vorticity"><code>IncompressibleNavierStokes.vorticity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity(u, setup)</code></pre><p>Compute vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.vorticity!" href="#IncompressibleNavierStokes.vorticity!"><code>IncompressibleNavierStokes.vorticity!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity!(ω, u, setup)</code></pre><p>Compute vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L70-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.convection!" href="#IncompressibleNavierStokes.convection!"><code>IncompressibleNavierStokes.convection!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convection!(F, u, setup)</code></pre><p>Compute convective term.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.diffusion!" href="#IncompressibleNavierStokes.diffusion!"><code>IncompressibleNavierStokes.diffusion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diffusion!(F, u, setup)</code></pre><p>Compute diffusive term.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.bodyforce!" href="#IncompressibleNavierStokes.bodyforce!"><code>IncompressibleNavierStokes.bodyforce!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bodyforce!(F, u, setup)</code></pre><p>Compute body force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L192-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.momentum!" href="#IncompressibleNavierStokes.momentum!"><code>IncompressibleNavierStokes.momentum!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum!(F, u, t, setup)</code></pre><p>Right hand side of momentum equations, excluding pressure gradient. Put the result in <span>$F$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L222-L227">source</a></section></article><h2 id="Postprocess"><a class="docs-heading-anchor" href="#Postprocess">Postprocess</a><a id="Postprocess-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocess" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plot_force" href="#IncompressibleNavierStokes.plot_force"><code>IncompressibleNavierStokes.plot_force</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_force(setup, t; kwargs...)</code></pre><p>Plot body force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/plot_force.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plot_grid" href="#IncompressibleNavierStokes.plot_grid"><code>IncompressibleNavierStokes.plot_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_grid(x, y)
plot_grid(x, y, z)
plot_grid(grid)</code></pre><p>Plot nonuniform Cartesian grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/plot_grid.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plot_pressure" href="#IncompressibleNavierStokes.plot_pressure"><code>IncompressibleNavierStokes.plot_pressure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_pressure(setup, p; kwargs...)</code></pre><p>Plot pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/plot_pressure.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plot_streamfunction" href="#IncompressibleNavierStokes.plot_streamfunction"><code>IncompressibleNavierStokes.plot_streamfunction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_streamfunction(setup, V, t; kwargs...)</code></pre><p>Plot streamfunction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/plot_streamfunction.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plot_velocity" href="#IncompressibleNavierStokes.plot_velocity"><code>IncompressibleNavierStokes.plot_velocity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_velocity(setup, V, t; kwargs...)</code></pre><p>Plot velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/plot_velocity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plot_vorticity" href="#IncompressibleNavierStokes.plot_vorticity"><code>IncompressibleNavierStokes.plot_vorticity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_vorticity(setup, V, t; kwargs...)</code></pre><p>Plot vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/plot_vorticity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.save_vtk" href="#IncompressibleNavierStokes.save_vtk"><code>IncompressibleNavierStokes.save_vtk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">save_vtk(setup, u, p, filename = &quot;output/solution&quot;)</code></pre><p>Save velocity and pressure field to a VTK file.</p><p>In the case of a 2D setup, the velocity field is saved as a 3D vector with a z-component of zero, as this seems to be preferred by ParaView.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/postprocess/save_vtk.jl#L1-L8">source</a></section></article><h2 id="Preprocess"><a class="docs-heading-anchor" href="#Preprocess">Preprocess</a><a id="Preprocess-1"></a><a class="docs-heading-anchor-permalink" href="#Preprocess" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.create_initial_conditions" href="#IncompressibleNavierStokes.create_initial_conditions"><code>IncompressibleNavierStokes.create_initial_conditions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_initial_conditions(
    setup,
    initial_velocity,
    t = 0;
    pressure_solver = DirectPressureSolver(setup),
)</code></pre><p>Create initial vectors <code>(u, p)</code> at starting time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/create_initial_conditions.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.random_field" href="#IncompressibleNavierStokes.random_field"><code>IncompressibleNavierStokes.random_field</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">random_field(
    setup, t;
    A = setup.grid.N[1] * 10_000,
    σ = 30,
    s = 5,
    pressure_solver = DirectPressureSolver(setup),
)</code></pre><p>Create random field.</p><ul><li><code>K</code>: Maximum wavenumber</li><li><code>A</code>: Eddy amplitude</li><li><code>σ</code>: Variance</li><li><code>s</code> Wavenumber offset before energy starts decaying</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/create_initial_conditions.jl#L84-L99">source</a></section></article><h2 id="Processors"><a class="docs-heading-anchor" href="#Processors">Processors</a><a id="Processors-1"></a><a class="docs-heading-anchor-permalink" href="#Processors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.step_logger" href="#IncompressibleNavierStokes.step_logger"><code>IncompressibleNavierStokes.step_logger</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step_logger(; nupdate = 1)</code></pre><p>Create processor that logs time step information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/processors.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.vtk_writer" href="#IncompressibleNavierStokes.vtk_writer"><code>IncompressibleNavierStokes.vtk_writer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vtk_writer(
    setup;
    nupdate = 1,
    dir = &quot;output&quot;,
    filename = &quot;solution&quot;,
    fields = (:velocity, :pressure, :vorticity),
)</code></pre><p>Create processor that writes the solution every <code>nupdate</code> time steps to a VTK file. The resulting Paraview data collection file is stored in <code>&quot;$dir/$filename.pvd&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/processors.jl#L58-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.field_saver" href="#IncompressibleNavierStokes.field_saver"><code>IncompressibleNavierStokes.field_saver</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">field_saver(setup; nupdate = 1)</code></pre><p>Create processor that stores the solution every <code>nupdate</code> time step to the vector of vectors <code>V</code> and <code>p</code>. The solution times are stored in the vector <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/processors.jl#L122-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.field_plotter" href="#IncompressibleNavierStokes.field_plotter"><code>IncompressibleNavierStokes.field_plotter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">field_plotter(
    setup;
    fieldname = :vorticity,
    type = nothing,
    sleeptime = 0.001,
    alpha = 0.05,
)</code></pre><p>Plot the solution every time the state <code>o</code> is updated.</p><p>The <code>sleeptime</code> is slept at every update, to give Makie time to update the plot. Set this to <code>nothing</code> to skip sleeping.</p><p>Available fieldnames are:</p><ul><li><code>:velocity</code>,</li><li><code>:vorticity</code>,</li><li><code>:streamfunction</code>,</li><li><code>:pressure</code>.</li></ul><p>Available plot <code>type</code>s for 2D are:</p><ul><li><code>heatmap</code> (default),</li><li><code>image</code>,</li><li><code>contour</code>,</li><li><code>contourf</code>.</li></ul><p>Available plot <code>type</code>s for 3D are:</p><ul><li><code>contour</code> (default).</li></ul><p>The <code>alpha</code> value gets passed to <code>contour</code> in 3D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/real_time_plot.jl#L1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.energy_history_plotter" href="#IncompressibleNavierStokes.energy_history_plotter"><code>IncompressibleNavierStokes.energy_history_plotter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_history_plotter(setup)</code></pre><p>Create energy history plot, with a history point added every time <code>step_observer</code> is updated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/real_time_plot.jl#L232-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.energy_spectrum_plotter" href="#IncompressibleNavierStokes.energy_spectrum_plotter"><code>IncompressibleNavierStokes.energy_spectrum_plotter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_spectrum_plotter(setup; nupdate = 1)</code></pre><p>Create energy spectrum plot, redrawn every time <code>step_observer</code> is updated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/real_time_plot.jl#L253-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.animator" href="#IncompressibleNavierStokes.animator"><code>IncompressibleNavierStokes.animator</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">animator(setup, path; nupdate = 1, plotter = field_plotter(setup); kwargs...)</code></pre><p>Animate a plot of the solution every <code>update</code> iteration. The animation is saved to <code>path</code>, which should have one of the following extensions:</p><ul><li>&quot;.mkv&quot;</li><li>&quot;.mp4&quot;</li><li>&quot;.webm&quot;</li><li>&quot;.gif&quot;</li></ul><p>The plot is determined by a <code>plotter</code> processsor. Addtional <code>kwargs</code> are passed to Makie&#39;s <code>VideoStream</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/processors/animator.jl#L1-L15">source</a></section></article><h2 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.get_timestep" href="#IncompressibleNavierStokes.get_timestep"><code>IncompressibleNavierStokes.get_timestep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_timestep(stepper, cfl; bc_vectors)</code></pre><p>Estimate time step based on eigenvalues of operators, using Gershgorin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/get_timestep.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.solve_unsteady" href="#IncompressibleNavierStokes.solve_unsteady"><code>IncompressibleNavierStokes.solve_unsteady</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function solve_unsteady(
    setup, u₀, p₀, tlims;
    method = RK44(; T = eltype(u₀)),
    pressure_solver = DirectPressureSolver(setup),
    Δt = zero(eltype(u₀)),
    cfl = 1,
    n_adapt_Δt = 1,
    inplace = true,
    processors = (),
)</code></pre><p>Solve unsteady problem using <code>method</code>.</p><p>If <code>Δt</code> is a real number, it is rounded such that <code>(t_end - t_start) / Δt</code> is an integer. If <code>Δt = nothing</code>, the time step is chosen every <code>n_adapt_Δt</code> iteration with CFL-number <code>cfl</code> .</p><p>Each <code>processor</code> is called after every <code>processor.nupdate</code> time step.</p><p>All arrays and operators are passed through the <code>device</code> function. This allows for performing computations on a different device than the host (CPU). To compute on an Nvidia GPU using CUDA, change</p><pre><code class="nohighlight hljs">solve_unsteady(setup, u₀, p₀, tlims; kwargs...)</code></pre><p>to the following:</p><pre><code class="nohighlight hljs">using CUDA
solve_unsteady(
    setup, u₀, p₀, tlims;
    device = cu,
    kwargs...
)</code></pre><p>Note that the <code>state</code> observable passed to the <code>processor.initialize</code> function contains vector living on the device, and you may have to move them back to the host using <code>Array(u)</code> and <code>Array(p)</code> in the processor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/solve_unsteady.jl#L1-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.solve_steady_state" href="#IncompressibleNavierStokes.solve_steady_state"><code>IncompressibleNavierStokes.solve_steady_state</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function solve_steady_state(
    setup, V₀, p₀;
    jacobian_type = :newton,
    npicard = 2,
    abstol = 1e-10,
    maxiter = 10,
)</code></pre><p>Solve steady state problem of the Navier-Stokes equations. This saddlepoint system arises from linearization of the convective terms.</p><p>Each <code>processor</code> is called after every <code>processor.nupdate</code> iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/solve_steady_state.jl#L1-L14">source</a></section></article><h3 id="Pressure-solvers"><a class="docs-heading-anchor" href="#Pressure-solvers">Pressure solvers</a><a id="Pressure-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Pressure-solvers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractPressureSolver" href="#IncompressibleNavierStokes.AbstractPressureSolver"><code>IncompressibleNavierStokes.AbstractPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractPressureSolver</code></pre><p>Pressure solver for the Poisson equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_solvers.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.DirectPressureSolver" href="#IncompressibleNavierStokes.DirectPressureSolver"><code>IncompressibleNavierStokes.DirectPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DirectPressureSolver()</code></pre><p>Direct pressure solver using a LU decomposition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_solvers.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.CGPressureSolver" href="#IncompressibleNavierStokes.CGPressureSolver"><code>IncompressibleNavierStokes.CGPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CGPressureSolver(setup; [abstol], [reltol], [maxiter])</code></pre><p>Conjugate gradients iterative pressure solver.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_solvers.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.CGPressureSolverManual" href="#IncompressibleNavierStokes.CGPressureSolverManual"><code>IncompressibleNavierStokes.CGPressureSolverManual</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CGPressureSolverManual(setup; [abstol], [reltol], [maxiter])</code></pre><p>Conjugate gradients iterative pressure solver.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_solvers.jl#L62-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.SpectralPressureSolver" href="#IncompressibleNavierStokes.SpectralPressureSolver"><code>IncompressibleNavierStokes.SpectralPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpectralPressureSolver(setup)</code></pre><p>Build spectral pressure solver from setup.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_solvers.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_additional_solve" href="#IncompressibleNavierStokes.pressure_additional_solve"><code>IncompressibleNavierStokes.pressure_additional_solve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_additional_solve(pressure_solver, u, t, setup)</code></pre><p>Do additional pressure solve. This makes the pressure compatible with the velocity field, resulting in same order pressure as velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_additional_solve.jl#L31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_additional_solve!" href="#IncompressibleNavierStokes.pressure_additional_solve!"><code>IncompressibleNavierStokes.pressure_additional_solve!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_additional_solve!(pressure_solver, u, p, t, setup, F, f, M)</code></pre><p>Do additional pressure solve. This makes the pressure compatible with the velocity field, resulting in same order pressure as velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_additional_solve.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_poisson" href="#IncompressibleNavierStokes.pressure_poisson"><code>IncompressibleNavierStokes.pressure_poisson</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_poisson(solver, f)</code></pre><p>Solve the Poisson equation for the pressure with right hand side <code>f</code> at time <code>t</code>. For periodic and no-slip BC, the sum of <code>f</code> should be zero.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.pressure_poisson!"><code>pressure_poisson!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_poisson.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_poisson!" href="#IncompressibleNavierStokes.pressure_poisson!"><code>IncompressibleNavierStokes.pressure_poisson!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_poisson!(solver, p, f)</code></pre><p>Solve the Poisson equation for the pressure with right hand side <code>f</code> at time <code>t</code>. For periodic and no-slip BC, the sum of <code>f</code> should be zero.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.pressure_poisson"><code>pressure_poisson</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/solvers/pressure/pressure_poisson.jl#L19-L28">source</a></section></article><h2 id="Time-steppers"><a class="docs-heading-anchor" href="#Time-steppers">Time steppers</a><a id="Time-steppers-1"></a><a class="docs-heading-anchor-permalink" href="#Time-steppers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractODEMethod" href="#IncompressibleNavierStokes.AbstractODEMethod"><code>IncompressibleNavierStokes.AbstractODEMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractODEMethod</code></pre><p>Abstract ODE method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractRungeKuttaMethod" href="#IncompressibleNavierStokes.AbstractRungeKuttaMethod"><code>IncompressibleNavierStokes.AbstractRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractRungeKuttaMethod</code></pre><p>Abstract Runge Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod" href="#IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod"><code>IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AdamsBashforthCrankNicolsonMethod(
    T = Float64;
    α₁ = T(3 // 2),
    α₂ = T(-1 // 2),
    θ = T(1 // 2),
    p_add_solve = true,
    method_startup = RK44(; T),
)</code></pre><p>IMEX AB-CN: Adams-Bashforth for explicit convection (parameters <code>α₁</code> and <code>α₂</code>) and Crank-Nicolson for implicit diffusion (implicitness <code>θ</code>). The method is second order for <code>θ = 1/2</code>.</p><p>The LU decomposition of the LHS matrix is computed every time the time step changes.</p><p>Note that, in constrast to explicit methods, the pressure from previous time steps has an influence on the accuracy of the velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L8-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.OneLegMethod" href="#IncompressibleNavierStokes.OneLegMethod"><code>IncompressibleNavierStokes.OneLegMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OneLegMethod(
    T = Float64;
    β = T(1 // 2),
    p_add_solve = true,
    method_startup = RK44(; T),
)</code></pre><p>Explicit one-leg β-method following symmetry-preserving discretization of turbulent flow. See Verstappen and Veldman <a href="../../references/#Verstappen2003">[5]</a> <a href="../../references/#Verstappen1997">[6]</a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L44-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.ExplicitRungeKuttaMethod" href="#IncompressibleNavierStokes.ExplicitRungeKuttaMethod"><code>IncompressibleNavierStokes.ExplicitRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExplicitRungeKuttaMethod(; A, b, c, r, p_add_solve = true)</code></pre><p>Explicit Runge Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.ImplicitRungeKuttaMethod" href="#IncompressibleNavierStokes.ImplicitRungeKuttaMethod"><code>IncompressibleNavierStokes.ImplicitRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ImplicitRungeKuttaMethod(;
    A,
    b,
    c,
    r,
    newton_type = :full,
    maxiter = 10,
    abstol = 1e-14,
    reltol = 1e-14,
    p_add_solve = true,
)</code></pre><p>Implicit Runge Kutta method.</p><p>The implicit linear system is solved at each time step using Newton&#39;s method. The <code>newton_type</code> may be one of the following:</p><ul><li><code>:no</code>: Replace iteration matrix with I/Δt (no Jacobian)</li><li><code>:approximate</code>: Build Jacobian once before iterations only</li><li><code>:full</code>: Build Jacobian at each iteration</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L88-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.isexplicit" href="#IncompressibleNavierStokes.isexplicit"><code>IncompressibleNavierStokes.isexplicit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">isexplicit(method)</code></pre><p>Return <code>true</code> if <code>method</code> is explicit, i.e. the value at a certain time step is given explicitly as a function of the previous time steps only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/isexplicit.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.lambda_conv_max" href="#IncompressibleNavierStokes.lambda_conv_max"><code>IncompressibleNavierStokes.lambda_conv_max</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lambda_conv_max(method)</code></pre><p>Get maximum value of stability region for the convection operator (not a very good indication for the methods that do not include the imaginary axis)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/lambda_max.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.lambda_diff_max" href="#IncompressibleNavierStokes.lambda_diff_max"><code>IncompressibleNavierStokes.lambda_diff_max</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lambda_diff_max(method)</code></pre><p>Get maximum value of stability region for the diffusion operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/lambda_max.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.nstage" href="#IncompressibleNavierStokes.nstage"><code>IncompressibleNavierStokes.nstage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nstage(rk_method)</code></pre><p>Get number of stages of the Runge-Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/nstage.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.ode_method_cache" href="#IncompressibleNavierStokes.ode_method_cache"><code>IncompressibleNavierStokes.ode_method_cache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ode_method_cache(method, setup)</code></pre><p>Get time stepper cache for the given ODE method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/time_stepper_caches.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.runge_kutta_method" href="#IncompressibleNavierStokes.runge_kutta_method"><code>IncompressibleNavierStokes.runge_kutta_method</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">runge_kutta_method(A, b, c, r; [p_add_solve], [newton_type], [maxiter], [abstol], [reltol])</code></pre><p>Get Runge Kutta method. The function checks whether the method is explicit.</p><p><code>p_add_solve</code>: whether to add a pressure solve step to the method.</p><p>For implicit RK methods: <code>newton_type</code>, <code>maxiter</code>, <code>abstol</code>, <code>reltol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/methods.jl#L122-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.timestep" href="#IncompressibleNavierStokes.timestep"><code>IncompressibleNavierStokes.timestep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step(stepper, Δt; bc_vectors = nothing)</code></pre><p>Perform one time step.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.timestep!"><code>timestep!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/step.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.timestep!" href="#IncompressibleNavierStokes.timestep!"><code>IncompressibleNavierStokes.timestep!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step!(stepper, Δt; cache, momentum_cache, bc_vectors = nothing)</code></pre><p>Perform one time step&gt;</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.timestep"><code>timestep</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/step.jl#L13-L21">source</a></section></article><h2 id="Utils"><a class="docs-heading-anchor" href="#Utils">Utils</a><a id="Utils-1"></a><a class="docs-heading-anchor-permalink" href="#Utils" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.get_lims" href="#IncompressibleNavierStokes.get_lims"><code>IncompressibleNavierStokes.get_lims</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_lims(x, n = 1.5)</code></pre><p>Get approximate lower and upper limits of a field <code>x</code> based on the mean and standard deviation (<span>$\mu \pm n \sigma$</span>). If <code>x</code> is constant, a margin of <code>1e-4</code> is enforced. This is required for contour plotting functions that require a certain range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/utils/get_lims.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plotmat" href="#IncompressibleNavierStokes.plotmat"><code>IncompressibleNavierStokes.plotmat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plotmat(A)</code></pre><p>Plot matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/utils/plotmat.jl#L1-L5">source</a></section></article><h2 id="Other"><a class="docs-heading-anchor" href="#Other">Other</a><a id="Other-1"></a><a class="docs-heading-anchor-permalink" href="#Other" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.DirichletBC" href="#IncompressibleNavierStokes.DirichletBC"><code>IncompressibleNavierStokes.DirichletBC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DirichletBC()</code></pre><p>No split boundary conditions, where all velocity components are zero.</p><pre><code class="nohighlight hljs">DirichletBC(u, dudt)</code></pre><p>Dirichlet boundary conditions for the velocity, where <code>u[1] = (x..., t) -&gt; u1_BC</code> up to <code>u[d] = (x..., t) -&gt; ud_BC</code>, where <code>d</code> is the dimension.</p><p>To make the pressure the same order as velocity, also provide <code>dudt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/boundary_conditions.jl#L5-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.SymmetricBC" href="#IncompressibleNavierStokes.SymmetricBC"><code>IncompressibleNavierStokes.SymmetricBC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SymmetricBC()</code></pre><p>Symmetric boundary conditions. The parallel velocity and pressure is the same at each side of the boundary. The normal velocity is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/boundary_conditions.jl#L24-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.PressureBC" href="#IncompressibleNavierStokes.PressureBC"><code>IncompressibleNavierStokes.PressureBC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PressureBC()</code></pre><p>Pressure boundary conditions. The pressure is prescribed on the boundary (usually an &quot;outlet&quot;). The velocity has zero Neumann conditions.</p><p>Note: Currently, the pressure is prescribed with the constant value of zero on the entire boundary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/boundary_conditions.jl#L33-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.kinetic_energy" href="#IncompressibleNavierStokes.kinetic_energy"><code>IncompressibleNavierStokes.kinetic_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">kinetic_energy(setup, u)</code></pre><p>Compute total kinetic energy. The velocity components are interpolated to the volume centers and squared.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L464-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.FourierLayer" href="#IncompressibleNavierStokes.FourierLayer"><code>IncompressibleNavierStokes.FourierLayer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FourierLayer(dimension, kmax, cin =&gt; cout; σ = identity, init_weight = glorot_uniform)</code></pre><p>Fourier layer operating on uniformly discretized functions.</p><p>Some important sizes:</p><ul><li><code>dimension</code>: Spatial dimension, e.g. <code>Dimension(2)</code> or <code>Dimension(3)</code>.</li><li><code>(nx..., cin, nsample)</code>: Input size</li><li><code>(nx..., cout, nsample)</code>: Output size</li><li><code>nx = fill(n, dimension())</code>: Number of points in each spatial dimension</li><li><code>n ≥ kmax</code>: Same number of points in each spatial dimension, must be larger than cut-off wavenumber</li><li><code>kmax</code>: Cut-off wavenumber</li><li><code>nsample</code>: Number of input samples (treated independently)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/closures/fno.jl#L72-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.offset_p" href="#IncompressibleNavierStokes.offset_p"><code>IncompressibleNavierStokes.offset_p</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">offset_p(bc)</code></pre><p>Number of non-DOF pressure components at boundary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/boundary_conditions.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.momentum_allstage" href="#IncompressibleNavierStokes.momentum_allstage"><code>IncompressibleNavierStokes.momentum_allstage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum_allstage(Vⱼ, ϕⱼ, pⱼ, tⱼ, setup; bc_vectors, nstage, get_jacobian = false)</code></pre><p>Call momentum for multiple <code>(Vⱼ, pⱼ)</code> pairs, as required in implicit RK methods.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.momentum_allstage!"><code>momentum_allstage!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/step_implicit_runge_kutta.jl#L411-L419">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.momentum_allstage!" href="#IncompressibleNavierStokes.momentum_allstage!"><code>IncompressibleNavierStokes.momentum_allstage!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum_allstage!(
    Fⱼ,
    ∇Fⱼ,
    Vⱼ,
    ϕⱼ,
    pⱼ,
    tⱼ,
    setup,
    cache,
    momentum_cache;
    bc_vectors,
    nstage,
    get_jacobian = false,
)</code></pre><p>Call momentum for multiple <code>(V, p)</code> pairs, as required in implicit RK methods.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.momentum_allstage"><code>momentum_allstage</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/time_steppers/step_implicit_runge_kutta.jl#L449-L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.offset_u" href="#IncompressibleNavierStokes.offset_u"><code>IncompressibleNavierStokes.offset_u</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">offset_u(bc, isnormal, atend)</code></pre><p>Number of non-DOF velocity components at boundary. If <code>isnormal</code>, then the velocity is normal to the boundary, else parallel. If <code>atend</code>, it is at the end/right/rear/top boundary, otherwise beginning.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/boundary_conditions.jl#L72-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressuregradient" href="#IncompressibleNavierStokes.pressuregradient"><code>IncompressibleNavierStokes.pressuregradient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressuregradient(p, setup)</code></pre><p>Compute pressure gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L281-L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressuregradient!" href="#IncompressibleNavierStokes.pressuregradient!"><code>IncompressibleNavierStokes.pressuregradient!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressuregradient!(G, p, setup)</code></pre><p>Compute pressure gradient (in-place).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L257-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.momentum" href="#IncompressibleNavierStokes.momentum"><code>IncompressibleNavierStokes.momentum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum(u, t, setup)</code></pre><p>Right hand side of momentum equations, excluding pressure gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L242-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Dfield!" href="#IncompressibleNavierStokes.Dfield!"><code>IncompressibleNavierStokes.Dfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Dfield!(d, G, p, setup; ϵ = eps(eltype(p)))</code></pre><p>Compute the <span>$D$</span>-field <a href="../../references/#LiJiajia2019">[7]</a> given by</p><p class="math-container">\[D = \frac{2 | \nabla p |}{\nabla^2 p}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L371-L379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Qfield!" href="#IncompressibleNavierStokes.Qfield!"><code>IncompressibleNavierStokes.Qfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Qfield!(Q, u, setup; ϵ = eps(eltype(Q)))</code></pre><p>Compute <span>$Q$</span>-field <a href="../../references/#Jeong1995">[8]</a> given by</p><p class="math-container">\[Q = - \frac{1}{2} \sum_{α, β} \frac{\partial u^α}{\partial x^β}
\frac{\partial u^β}{\partial x^α}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L426-L435">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Offset" href="#IncompressibleNavierStokes.Offset"><code>IncompressibleNavierStokes.Offset</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">δ = Offset{D}()</code></pre><p>Carsesian index unit vector in <code>D = 2</code> or <code>D = 3</code> dimensions. Calling <code>δ(α)</code> returns a Cartesian index with <code>1</code> in the dimension <code>α</code> and zeros elsewhere.</p><p>See <a href="https://b-fg.github.io/2023/05/07/waterlily-on-gpu.html">https://b-fg.github.io/2023/05/07/waterlily-on-gpu.html</a> for writing kernel loops using Cartesian indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/7b4377267f28ea146fb82b5e6388b74a0667740d/src/operators.jl#L1-L10">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../features/steppers/">« Time steppers</a><a class="docs-footer-nextpage" href="../tableaux/">Runge-Kutta methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Monday 23 October 2023 18:28">Monday 23 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
