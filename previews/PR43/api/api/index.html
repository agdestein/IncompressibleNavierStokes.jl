<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · IncompressibleNavierStokes.jl</title><meta name="title" content="API · IncompressibleNavierStokes.jl"/><meta property="og:title" content="API · IncompressibleNavierStokes.jl"/><meta property="twitter:title" content="API · IncompressibleNavierStokes.jl"/><meta name="description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="twitter:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><meta property="twitter:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Tutorial: Lid-Driven Cavity (2D)</a></li><li><a class="tocitem" href="../../generated/TaylorGreenVortex2D/">Convergence: Taylor-Green Vortex (2D)</a></li><li><a class="tocitem" href="../../generated/Actuator2D/">Unsteady inflow: Actuator (2D)</a></li><li><a class="tocitem" href="../../generated/BackwardFacingStep2D/">Walls: Backward Facing Step (2D)</a></li><li><a class="tocitem" href="../../generated/DecayingTurbulence2D/">Decaying Turbulunce (2D)</a></li><li><a class="tocitem" href="../../generated/PlanarMixing2D/">Planar Mixing (2D)</a></li></ul></li><li><span class="tocitem">Equations</span><ul><li><a class="tocitem" href="../../equations/ns/">Incompressible Navier-Stokes equations</a></li><li><a class="tocitem" href="../../equations/spatial/">Spatial discretization</a></li><li><a class="tocitem" href="../../equations/time/">Time discretization</a></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../../features/bc/">Boundary conditions</a></li><li><a class="tocitem" href="../../features/pressure/">Pressure solvers</a></li><li><a class="tocitem" href="../../features/precision/">Floating point precision</a></li><li><a class="tocitem" href="../../features/gpu/">GPU Support</a></li><li><a class="tocitem" href="../../features/operators/">Operators</a></li><li><a class="tocitem" href="../../features/les/">Large eddy simulation</a></li><li><a class="tocitem" href="../../features/closure/">Neural closure models</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Grid"><span>Grid</span></a></li><li><a class="tocitem" href="#Preprocess"><span>Preprocess</span></a></li><li><a class="tocitem" href="#Processors"><span>Processors</span></a></li><li><a class="tocitem" href="#Solvers"><span>Solvers</span></a></li><li><a class="tocitem" href="#Utils"><span>Utils</span></a></li></ul></li><li><a class="tocitem" href="../tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/api/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.IncompressibleNavierStokes" href="#IncompressibleNavierStokes.IncompressibleNavierStokes"><code>IncompressibleNavierStokes.IncompressibleNavierStokes</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">IncompressibleNavierStokes</code></pre><p>Energy-conserving solvers for the incompressible Navier-Stokes equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/IncompressibleNavierStokes.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Setup" href="#IncompressibleNavierStokes.Setup"><code>IncompressibleNavierStokes.Setup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Setup(
    x...;
    boundary_conditions = ntuple(d -&gt; (PeriodicBC(), PeriodicBC()), length(x)),
    Re = convert(eltype(x[1]), 1_000),
    viscosity_model = LaminarModel(),
    bodyforce = nothing,
    issteadybodyforce = true,
    closure_model = nothing,
    ArrayType = Array,
    workgroupsize = 64,
)</code></pre><p>Create setup.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/setup.jl#L1-L15">source</a></section></article><h2 id="Grid"><a class="docs-heading-anchor" href="#Grid">Grid</a><a id="Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Grid" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Dimension" href="#IncompressibleNavierStokes.Dimension"><code>IncompressibleNavierStokes.Dimension</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Dimension(N)</code></pre><p>Represent an <code>N</code>-dimensional space. Returns <code>N</code> when called.</p><pre><code class="language-example hljs">julia&gt; d = Dimension(3)
Dimension{3}()

julia&gt; d()
3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/grid/dimension.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Grid" href="#IncompressibleNavierStokes.Grid"><code>IncompressibleNavierStokes.Grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Grid(x, boundary_conditions)</code></pre><p>Create nonuniform Cartesian box mesh <code>x[1]</code> × ... × <code>x[d]</code> with boundary conditions <code>boundary_conditions</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/grid/grid.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.cosine_grid" href="#IncompressibleNavierStokes.cosine_grid"><code>IncompressibleNavierStokes.cosine_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cosine_grid(a, b, N)</code></pre><p>Create a nonuniform grid of <code>N + 1</code> points from <code>a</code> to <code>b</code> using a cosine profile, i.e.</p><p class="math-container">\[x_i = a + \frac{1}{2} \left( 1 - \cos \left( \pi \frac{i}{n} \right) \right)
(b - a), \quad i = 0, \dots, N\]</p><p>See also <a href="#IncompressibleNavierStokes.stretched_grid"><code>stretched_grid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/grid/cosine_grid.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.max_size" href="#IncompressibleNavierStokes.max_size"><code>IncompressibleNavierStokes.max_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">max_size(grid)</code></pre><p>Get size of the largest grid element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/grid/max_size.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.stretched_grid" href="#IncompressibleNavierStokes.stretched_grid"><code>IncompressibleNavierStokes.stretched_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stretched_grid(a, b, N, s = 1)</code></pre><p>Create a nonuniform grid of <code>N + 1</code> points from <code>a</code> to <code>b</code> with a stretch factor of <code>s</code>. If <code>s = 1</code>, return a uniform spacing from <code>a</code> to <code>b</code>. Otherwise, return a vector <span>$x \in \mathbb{R}^{N + 1}$</span> such that <span>$x_n = a + \sum_{i = 1}^n s^{i - 1} h$</span> for <span>$n = 0, \dots , N$</span>. Setting <span>$x_N = b$</span> then gives <span>$h = (b - a) \frac{1 - s}{1 - s^N}$</span>, resulting in</p><p class="math-container">\[x_n = a + (b - a) \frac{1 - s^n}{1 - s^N}, \quad n = 0, \dots, N.\]</p><p>Note that <code>stretched_grid(a, b, N, s)[n]</code> corresponds to <span>$x_{n - 1}$</span>.</p><p>See also <a href="#IncompressibleNavierStokes.cosine_grid"><code>cosine_grid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/grid/stretched_grid.jl#L1-L17">source</a></section></article><h2 id="Preprocess"><a class="docs-heading-anchor" href="#Preprocess">Preprocess</a><a id="Preprocess-1"></a><a class="docs-heading-anchor-permalink" href="#Preprocess" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.create_initial_conditions" href="#IncompressibleNavierStokes.create_initial_conditions"><code>IncompressibleNavierStokes.create_initial_conditions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_initial_conditions(
    setup,
    initial_velocity,
    t = 0;
    psolver = DirectPressureSolver(setup),
    doproject = true,
)</code></pre><p>Create divergence free initial velocity field <code>u</code> at starting time <code>t</code>. The initial conditions of <code>u[α]</code> are specified by the function <code>initial_velocity(Dimension(α), x...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/create_initial_conditions.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.random_field" href="#IncompressibleNavierStokes.random_field"><code>IncompressibleNavierStokes.random_field</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">random_field(
    setup, t = 0;
    A = 1,
    kp = 10,
    psolver = SpectralPressureSolver(setup),
    rng = Random.default_rng(),
)</code></pre><p>Create random field, as in [<a href="../../references/#Orlandi2000">14</a>].</p><ul><li><code>K</code>: Maximum wavenumber</li><li><code>A</code>: Eddy amplitude scaling</li><li><code>kp</code>: Peak energy wavenumber</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/create_initial_conditions.jl#L173-L187">source</a></section></article><h2 id="Processors"><a class="docs-heading-anchor" href="#Processors">Processors</a><a id="Processors-1"></a><a class="docs-heading-anchor-permalink" href="#Processors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.processor" href="#IncompressibleNavierStokes.processor"><code>IncompressibleNavierStokes.processor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">processor(initialize, finalize = (initialized, state) -&gt; initialized)</code></pre><p>Process results from time stepping. Before time stepping, the <code>initialize</code> function is called on an observable of the time stepper <code>state</code>, returning <code>initialized</code>. The observable is updated every time step.</p><p>After timestepping, the <code>finalize</code> function is called on <code>initialized</code> and the final <code>state</code>.</p><p>See the following example:</p><pre><code class="language-example hljs">function initialize(state)
    s = 0
    println(&quot;Let&#39;s sum up the time steps&quot;)
    on(state) do (; n, t)
        println(&quot;The summand is $n, the time is $t&quot;)
        s = s + n
    end
    s
end

finalize(i, state) = println(&quot;The final sum (at time t=$(state.t)) is $s&quot;)
p = processor(initialize, finalize)</code></pre><p>When solved for 6 time steps from t=0 to t=2 the displayed output is</p><pre><code class="nohighlight hljs">Let&#39;s sum up the time steps
The summand is 0, the time is 0.0
The summand is 1, the time is 0.4
The summand is 2, the time is 0.8
The summand is 3, the time is 1.2
The summand is 4, the time is 1.6
The summand is 5, the time is 2.0
The final sum (at time t=2.0) is 15</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/processors.jl#L1-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.timelogger" href="#IncompressibleNavierStokes.timelogger"><code>IncompressibleNavierStokes.timelogger</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">timelogger(; nupdate = 1)</code></pre><p>Create processor that logs time step information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/processors.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.vtk_writer" href="#IncompressibleNavierStokes.vtk_writer"><code>IncompressibleNavierStokes.vtk_writer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vtk_writer(;
    setup,
    nupdate = 1,
    dir = &quot;output&quot;,
    filename = &quot;solution&quot;,
    fields = (:velocity, :pressure, :vorticity),
)</code></pre><p>Create processor that writes the solution every <code>nupdate</code> time steps to a VTK file. The resulting Paraview data collection file is stored in <code>&quot;$dir/$filename.pvd&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/processors.jl#L57-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.fieldsaver" href="#IncompressibleNavierStokes.fieldsaver"><code>IncompressibleNavierStokes.fieldsaver</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fieldsaver(; setup, nupdate = 1)</code></pre><p>Create processor that stores the solution and time every <code>nupdate</code> time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/processors.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.realtimeplotter" href="#IncompressibleNavierStokes.realtimeplotter"><code>IncompressibleNavierStokes.realtimeplotter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">realtimeplotter(;
    setup,
    plot = fieldplot,
    nupdate = 1,
    displayfig = true,
    displayupdates = false,
    sleeptime = nothing,
    kwargs...,
)</code></pre><p>Processor for plotting the solution every <code>nupdate</code> time step.</p><p>The <code>sleeptime</code> is slept at every update, to give Makie time to update the plot. Set this to <code>nothing</code> to skip sleeping.</p><p>Additional <code>kwargs</code> are passed to the <code>plot</code> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/real_time_plot.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.fieldplot" href="#IncompressibleNavierStokes.fieldplot"><code>IncompressibleNavierStokes.fieldplot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fieldplot(
    state;
    setup,
    fieldname = :vorticity,
    type = nothing,
    kwargs...,
)</code></pre><p>Plot <code>state</code> field in pressure points. If <code>state</code> is <code>Observable</code>, then the plot is interactive.</p><p>Available fieldnames are:</p><ul><li><code>:velocity</code>,</li><li><code>:vorticity</code>,</li><li><code>:streamfunction</code>,</li><li><code>:pressure</code>.</li></ul><p>Available plot <code>type</code>s for 2D are:</p><ul><li><code>heatmap</code> (default),</li><li><code>image</code>,</li><li><code>contour</code>,</li><li><code>contourf</code>.</li></ul><p>Available plot <code>type</code>s for 3D are:</p><ul><li><code>contour</code> (default).</li></ul><p>The <code>alpha</code> value gets passed to <code>contour</code> in 3D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/real_time_plot.jl#L41-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.energy_history_plot" href="#IncompressibleNavierStokes.energy_history_plot"><code>IncompressibleNavierStokes.energy_history_plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_history_plot(state; setup)</code></pre><p>Create energy history plot.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/real_time_plot.jl#L304-L308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.energy_spectrum_plot" href="#IncompressibleNavierStokes.energy_spectrum_plot"><code>IncompressibleNavierStokes.energy_spectrum_plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_spectrum_plot(state; setup)</code></pre><p>Create energy spectrum plot. The energy at a scalar wavenumber level <span>$\kappa \in \mathbb{N}$</span> is defined by</p><p class="math-container">\[\hat{e}(\kappa) = \int_{\kappa \leq \| k \|_2 &lt; \kappa + 1} | \hat{e}(k) | \mathrm{d} k,\]</p><p>as in San and Staples [<a href="../../references/#San2012">15</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/real_time_plot.jl#L325-L336">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.animator" href="#IncompressibleNavierStokes.animator"><code>IncompressibleNavierStokes.animator</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">animator(; setup, path, plot = fieldplot, nupdate = 1, kwargs...)</code></pre><p>Animate a plot of the solution every <code>update</code> iteration. The animation is saved to <code>path</code>, which should have one of the following extensions:</p><ul><li>&quot;.mkv&quot;</li><li>&quot;.mp4&quot;</li><li>&quot;.webm&quot;</li><li>&quot;.gif&quot;</li></ul><p>The plot is determined by a <code>plotter</code> processor. Additional <code>kwargs</code> are passed to <code>plot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/processors/animator.jl#L1-L15">source</a></section></article><h2 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.get_timestep" href="#IncompressibleNavierStokes.get_timestep"><code>IncompressibleNavierStokes.get_timestep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_timestep(stepper, cfl; bc_vectors)</code></pre><p>Estimate time step based on eigenvalues of operators, using Gershgorin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/solvers/get_timestep.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.solve_unsteady" href="#IncompressibleNavierStokes.solve_unsteady"><code>IncompressibleNavierStokes.solve_unsteady</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_unsteady(
    setup,
    u₀,
    tlims;
    method = RK44(; T = eltype(u₀[1])),
    psolver = DirectPressureSolver(setup),
    Δt = zero(eltype(u₀[1])),
    cfl = 1,
    n_adapt_Δt = 1,
    docopy = true,
    processors = (;),
)</code></pre><p>Solve unsteady problem using <code>method</code>.</p><p>If <code>Δt</code> is a real number, it is rounded such that <code>(t_end - t_start) / Δt</code> is an integer. If <code>Δt = nothing</code>, the time step is chosen every <code>n_adapt_Δt</code> iteration with CFL-number <code>cfl</code> .</p><p>The <code>processors</code> are called after every time step.</p><p>Note that the <code>state</code> observable passed to the <code>processor.initialize</code> function contains vector living on the device, and you may have to move them back to the host using <code>Array(u)</code> in the processor.</p><p>Return <code>(; u, t), outputs</code>, where <code>outputs</code> is a  named tuple with the outputs of <code>processors</code> with the same field names.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/solvers/solve_unsteady.jl#L1-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.solve_steady_state" href="#IncompressibleNavierStokes.solve_steady_state"><code>IncompressibleNavierStokes.solve_steady_state</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function solve_steady_state(
    setup, V₀, p₀;
    jacobian_type = :newton,
    npicard = 2,
    abstol = 1e-10,
    maxiter = 10,
)</code></pre><p>Solve steady state problem of the Navier-Stokes equations. This saddlepoint system arises from linearization of the convective terms.</p><p>Each <code>processor</code> is called after every <code>processor.nupdate</code> iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/solvers/solve_steady_state.jl#L1-L14">source</a></section></article><h2 id="Utils"><a class="docs-heading-anchor" href="#Utils">Utils</a><a id="Utils-1"></a><a class="docs-heading-anchor-permalink" href="#Utils" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.save_vtk" href="#IncompressibleNavierStokes.save_vtk"><code>IncompressibleNavierStokes.save_vtk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">save_vtk(setup, u, filename = &quot;output/solution&quot;; fieldnames = [:velocity], psolver)</code></pre><p>Save velocity and pressure field to a VTK file.</p><p>In the case of a 2D setup, the velocity field is saved as a 3D vector with a z-component of zero, as this seems to be preferred by ParaView.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/utils/save_vtk.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plotgrid" href="#IncompressibleNavierStokes.plotgrid"><code>IncompressibleNavierStokes.plotgrid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plotgrid(x...)</code></pre><p>Plot nonuniform Cartesian grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/utils/plotgrid.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.get_lims" href="#IncompressibleNavierStokes.get_lims"><code>IncompressibleNavierStokes.get_lims</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_lims(x, n = 1.5)</code></pre><p>Get approximate lower and upper limits of a field <code>x</code> based on the mean and standard deviation (<span>$\mu \pm n \sigma$</span>). If <code>x</code> is constant, a margin of <code>1e-4</code> is enforced. This is required for contour plotting functions that require a certain range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/utils/get_lims.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.plotmat" href="#IncompressibleNavierStokes.plotmat"><code>IncompressibleNavierStokes.plotmat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plotmat(A)</code></pre><p>Plot matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/68c33636965547239e2eed3077f6b02dc4732dc1/src/utils/plotmat.jl#L1-L5">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../features/closure/">« Neural closure models</a><a class="docs-footer-nextpage" href="../tableaux/">Runge-Kutta methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Sunday 21 April 2024 08:59">Sunday 21 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
