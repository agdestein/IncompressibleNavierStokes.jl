<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Operators · IncompressibleNavierStokes.jl</title><meta name="title" content="Operators · IncompressibleNavierStokes.jl"/><meta property="og:title" content="Operators · IncompressibleNavierStokes.jl"/><meta property="twitter:title" content="Operators · IncompressibleNavierStokes.jl"/><meta name="description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="twitter:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/features/operators/"/><meta property="twitter:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/features/operators/"/><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/features/operators/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Tutorial: Lid-Driven Cavity (2D)</a></li><li><a class="tocitem" href="../../generated/TaylorGreenVortex2D/">Convergence: Taylor-Green Vortex (2D)</a></li><li><a class="tocitem" href="../../generated/Actuator2D/">Unsteady inflow: Actuator (2D)</a></li><li><a class="tocitem" href="../../generated/BackwardFacingStep2D/">Walls: Backward Facing Step (2D)</a></li><li><a class="tocitem" href="../../generated/DecayingTurbulence2D/">Decaying Turbulunce (2D)</a></li><li><a class="tocitem" href="../../generated/RayleighBenard2D/">Temperature: Rayleigh-Bénard (2D)</a></li></ul></li><li><span class="tocitem">Equations</span><ul><li><a class="tocitem" href="../../equations/ns/">Incompressible Navier-Stokes equations</a></li><li><a class="tocitem" href="../../equations/spatial/">Spatial discretization</a></li><li><a class="tocitem" href="../../equations/time/">Time discretization</a></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../bc/">Boundary conditions</a></li><li><a class="tocitem" href="../pressure/">Pressure solvers</a></li><li><a class="tocitem" href="../precision/">Floating point precision</a></li><li><a class="tocitem" href="../gpu/">GPU Support</a></li><li class="is-active"><a class="tocitem" href>Operators</a></li><li><a class="tocitem" href="../temperature/">Temperature equation</a></li><li><a class="tocitem" href="../les/">Large eddy simulation</a></li><li><a class="tocitem" href="../closure/">Neural closure models</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/api/">API</a></li><li><a class="tocitem" href="../../api/tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Features</a></li><li class="is-active"><a href>Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/features/operators.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Operators"><a class="docs-heading-anchor" href="#Operators">Operators</a><a id="Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Operators" title="Permalink"></a></h1><p>All discrete operators are built using <a href="https://github.com/JuliaGPU/KernelAbstractions.jl/">KernelAbstractions.jl</a> and Cartesian indices, similar to <a href="https://github.com/weymouth/WaterLily.jl/">WaterLily.jl</a>. This allows for dimension- and backend-agnostic code. See this <a href="https://b-fg.github.io/2023/05/07/waterlily-on-gpu.html">blog post</a> for how to write kernels. IncompressibleNavierStokes previously relied on assembling sparse operators to perform the same operations. While being very efficient and also compatible with CUDA (CUSPARSE), storing these matrices in memory is expensive for large 3D problems.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Offset" href="#IncompressibleNavierStokes.Offset"><code>IncompressibleNavierStokes.Offset</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">e = Offset{D}()</code></pre><p>Cartesian index unit vector in <code>D = 2</code> or <code>D = 3</code> dimensions. Calling <code>e(α)</code> returns a Cartesian index with <code>1</code> in the dimension <code>α</code> and zeros elsewhere.</p><p>See <a href="https://b-fg.github.io/2023/05/07/waterlily-on-gpu.html">https://b-fg.github.io/2023/05/07/waterlily-on-gpu.html</a> for writing kernel loops using Cartesian indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L39-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.avg" href="#IncompressibleNavierStokes.avg"><code>IncompressibleNavierStokes.avg</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Average scalar field <code>ϕ</code> in the <code>α</code>-direction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L53-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.divergence!" href="#IncompressibleNavierStokes.divergence!"><code>IncompressibleNavierStokes.divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divergence!(div, u, setup)</code></pre><p>Compute divergence of velocity field (in-place version).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.divergence" href="#IncompressibleNavierStokes.divergence"><code>IncompressibleNavierStokes.divergence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divergence(u, setup)</code></pre><p>Compute divergence of velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.vorticity" href="#IncompressibleNavierStokes.vorticity"><code>IncompressibleNavierStokes.vorticity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity(u, setup)</code></pre><p>Compute vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1039-L1043">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.vorticity!" href="#IncompressibleNavierStokes.vorticity!"><code>IncompressibleNavierStokes.vorticity!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity!(ω, u, setup)</code></pre><p>Compute vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1051-L1055">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.convection!" href="#IncompressibleNavierStokes.convection!"><code>IncompressibleNavierStokes.convection!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convection!(F, u, setup)</code></pre><p>Compute convective term.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L404-L408">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.diffusion!" href="#IncompressibleNavierStokes.diffusion!"><code>IncompressibleNavierStokes.diffusion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diffusion!(F, u, setup)</code></pre><p>Compute diffusive term.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L569-L573">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.bodyforce!" href="#IncompressibleNavierStokes.bodyforce!"><code>IncompressibleNavierStokes.bodyforce!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bodyforce!(F, u, t, setup)</code></pre><p>Compute body force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L885-L889">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.momentum!" href="#IncompressibleNavierStokes.momentum!"><code>IncompressibleNavierStokes.momentum!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum!(F, u, temp, t, setup)</code></pre><p>Right hand side of momentum equations, excluding pressure gradient. Put the result in <span>$F$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L976-L981">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.momentum" href="#IncompressibleNavierStokes.momentum"><code>IncompressibleNavierStokes.momentum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum(u, temp, t, setup)</code></pre><p>Right hand side of momentum equations, excluding pressure gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1005-L1009">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.laplacian!" href="#IncompressibleNavierStokes.laplacian!"><code>IncompressibleNavierStokes.laplacian!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">laplacian!(L, p, setup)</code></pre><p>Compute Laplacian of pressure field (in-place version).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L227-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.laplacian" href="#IncompressibleNavierStokes.laplacian"><code>IncompressibleNavierStokes.laplacian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">laplacian(p, setup)</code></pre><p>Compute Laplacian of pressure field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L307-L311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressuregradient!" href="#IncompressibleNavierStokes.pressuregradient!"><code>IncompressibleNavierStokes.pressuregradient!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressuregradient!(G, p, setup)</code></pre><p>Compute pressure gradient (in-place).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L119-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.pressuregradient" href="#IncompressibleNavierStokes.pressuregradient"><code>IncompressibleNavierStokes.pressuregradient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressuregradient(p, setup)</code></pre><p>Compute pressure gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.interpolate_u_p" href="#IncompressibleNavierStokes.interpolate_u_p"><code>IncompressibleNavierStokes.interpolate_u_p</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">interpolate_u_p(u, setup)</code></pre><p>Interpolate velocity to pressure points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1285-L1289">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.interpolate_u_p!" href="#IncompressibleNavierStokes.interpolate_u_p!"><code>IncompressibleNavierStokes.interpolate_u_p!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">interpolate_u_p!(up, u, setup)</code></pre><p>Interpolate velocity to pressure points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1293-L1297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.interpolate_ω_p" href="#IncompressibleNavierStokes.interpolate_ω_p"><code>IncompressibleNavierStokes.interpolate_ω_p</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">interpolate_ω_p(ω, setup)</code></pre><p>Interpolate vorticity to pressure points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1316-L1320">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.interpolate_ω_p!" href="#IncompressibleNavierStokes.interpolate_ω_p!"><code>IncompressibleNavierStokes.interpolate_ω_p!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">interpolate_ω_p!(ωp, ω, setup)</code></pre><p>Interpolate vorticity to pressure points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1328-L1332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Dfield!" href="#IncompressibleNavierStokes.Dfield!"><code>IncompressibleNavierStokes.Dfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Dfield!(d, G, p, setup; ϵ = eps(eltype(p)))</code></pre><p>Compute the <span>$D$</span>-field [<a href="../../references/#LiJiajia2019">9</a>] given by</p><p class="math-container">\[D = \frac{2 | \nabla p |}{\nabla^2 p}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1371-L1379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Dfield" href="#IncompressibleNavierStokes.Dfield"><code>IncompressibleNavierStokes.Dfield</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Dfield(p, setup; kwargs...)</code></pre><p>Compute the <span>$D$</span>-field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1416-L1420">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Qfield!" href="#IncompressibleNavierStokes.Qfield!"><code>IncompressibleNavierStokes.Qfield!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Qfield!(Q, u, setup)</code></pre><p>Compute <span>$Q$</span>-field [<a href="../../references/#Jeong1995">10</a>] given by</p><p class="math-container">\[Q = - \frac{1}{2} \sum_{α, β} \frac{\partial u^α}{\partial x^β}
\frac{\partial u^β}{\partial x^α}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1429-L1438">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.Qfield" href="#IncompressibleNavierStokes.Qfield"><code>IncompressibleNavierStokes.Qfield</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Qfield(u, setup)</code></pre><p>Compute the <span>$Q$</span>-field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1461-L1465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.eig2field!" href="#IncompressibleNavierStokes.eig2field!"><code>IncompressibleNavierStokes.eig2field!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eig2field!(λ, u, setup; ϵ = eps(eltype(λ)))</code></pre><p>Compute the second eigenvalue of <span>$S^2 + \Omega^2$</span>, as proposed by Jeong and Hussain [<a href="../../references/#Jeong1995">10</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1468-L1473">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.eig2field" href="#IncompressibleNavierStokes.eig2field"><code>IncompressibleNavierStokes.eig2field</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">eig2field(u, setup)</code></pre><p>Compute the second eigenvalue of <span>$S^2 + \Omega^2$</span>, as proposed by Jeong and Hussain [<a href="../../references/#Jeong1995">10</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1494-L1499">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.kinetic_energy" href="#IncompressibleNavierStokes.kinetic_energy"><code>IncompressibleNavierStokes.kinetic_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">kinetic_energy(u, setup; kwargs...)</code></pre><p>Compute kinetic energy field <span>$e$</span> (out-of-place version).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1552-L1556">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.kinetic_energy!" href="#IncompressibleNavierStokes.kinetic_energy!"><code>IncompressibleNavierStokes.kinetic_energy!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">kinetic_energy!(k, u, setup; interpolate_first = false)</code></pre><p>Compute kinetic energy field <span>$k$</span> (in-place version). If <code>interpolate_first</code> is true, it is given by</p><p class="math-container">\[e_I = \frac{1}{8} \sum_\alpha (u^\alpha_{I + \delta(\alpha) / 2} + u^\alpha_{I - \delta(\alpha) / 2})^2.\]</p><p>Otherwise, it is given by</p><p class="math-container">\[e_I = \frac{1}{4} \sum_\alpha (u^\alpha_{I + \delta(\alpha) / 2}^2 + u^\alpha_{I - \delta(\alpha) / 2}^2),\]</p><p>as in [<a href="../../references/#Sanderse2023">11</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1502-L1519">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.total_kinetic_energy" href="#IncompressibleNavierStokes.total_kinetic_energy"><code>IncompressibleNavierStokes.total_kinetic_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">total_kinetic_energy(setup, u; kwargs...)</code></pre><p>Compute total kinetic energy. The velocity components are interpolated to the volume centers and squared.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1559-L1564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.tensorbasis" href="#IncompressibleNavierStokes.tensorbasis"><code>IncompressibleNavierStokes.tensorbasis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorbasis(u, setup)</code></pre><p>Compute symmetry tensor basis <code>T[1]</code>-<code>T[11]</code> and invariants <code>V[1]</code>-<code>V[5]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1269-L1273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.divoftensor!" href="#IncompressibleNavierStokes.divoftensor!"><code>IncompressibleNavierStokes.divoftensor!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divoftensor!(s, σ, setup)</code></pre><p>Compute divergence of a tensor with all components in the pressure points. The stress tensors should be precomputed and stored in <code>σ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1145-L1150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.tensorbasis!" href="#IncompressibleNavierStokes.tensorbasis!"><code>IncompressibleNavierStokes.tensorbasis!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorbasis!(B, V, u, setup)</code></pre><p>Compute symmetry tensor basis <code>B[1]</code>-<code>B[11]</code> and invariants <code>V[1]</code>-<code>V[5]</code>, as specified in [<a href="../../references/#Silvis2017">12</a>] in equations (9) and (11). Note that <code>B[1]</code> corresponds to <span>$T_0$</span> in the paper, and <code>V</code> to <span>$I$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1216-L1222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.get_scale_numbers" href="#IncompressibleNavierStokes.get_scale_numbers"><code>IncompressibleNavierStokes.get_scale_numbers</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_scale_numbers(u, setup)</code></pre><p>Get the following dimensional scale numbers [<a href="../../references/#Pope2000">13</a>]:</p><ul><li>Velocity <span>$u_\text{avg} = \langle u_i u_i \rangle^{1/2}$</span></li><li>Dissipation rate <span>$\epsilon = 2 \nu \langle S_{ij} S_{ij} \rangle$</span></li><li>Kolmolgorov length scale <span>$\eta = (\frac{\nu^3}{\epsilon})^{1/4}$</span></li><li>Taylor length scale <span>$\lambda = (\frac{5 \nu}{\epsilon})^{1/2} u_\text{avg}$</span></li><li>Taylor-scale Reynolds number <span>$Re_\lambda = \frac{\lambda u_\text{avg}}{\sqrt{3} \nu}$</span></li><li>Integral length scale <span>$L = \frac{3 \pi}{2 u_\text{avg}^2} \int_0^\infty \frac{E(k)}{k} \, \mathrm{d} k$</span></li><li>Large-eddy turnover time <span>$\tau = \frac{L}{u_\text{avg}}$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L1572-L1584">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncompressibleNavierStokes.dissipation_from_strain!" href="#IncompressibleNavierStokes.dissipation_from_strain!"><code>IncompressibleNavierStokes.dissipation_from_strain!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dissipation_from_strain!(ϵ, u, setup)</code></pre><p>Compute dissipation term <span>$2 \nu \langle S_{i j} S_{i j} \rangle$</span> from strain-rate tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/293de1c970ffcc18d6365024d95a6f94c8e09848/src/operators.jl#L858-L864">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gpu/">« GPU Support</a><a class="docs-footer-nextpage" href="../temperature/">Temperature equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Thursday 23 May 2024 19:26">Thursday 23 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
