<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spatial discretization · IncompressibleNavierStokes.jl</title><meta name="title" content="Spatial discretization · IncompressibleNavierStokes.jl"/><meta property="og:title" content="Spatial discretization · IncompressibleNavierStokes.jl"/><meta property="twitter:title" content="Spatial discretization · IncompressibleNavierStokes.jl"/><meta name="description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="twitter:description" content="Documentation for IncompressibleNavierStokes.jl."/><meta property="og:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/spatial/"/><meta property="twitter:url" content="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/spatial/"/><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/spatial/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Tutorial: Lid-Driven Cavity (2D)</a></li><li><a class="tocitem" href="../../generated/TaylorGreenVortex2D/">Convergence: Taylor-Green Vortex (2D)</a></li><li><a class="tocitem" href="../../generated/Actuator2D/">Unsteady inflow: Actuator (2D)</a></li><li><a class="tocitem" href="../../generated/BackwardFacingStep2D/">Walls: Backward Facing Step (2D)</a></li><li><a class="tocitem" href="../../generated/DecayingTurbulence2D/">Decaying Turbulunce (2D)</a></li><li><a class="tocitem" href="../../generated/RayleighBenard2D/">Temperature: Rayleigh-Bénard (2D)</a></li></ul></li><li><span class="tocitem">Equations</span><ul><li><a class="tocitem" href="../ns/">Incompressible Navier-Stokes equations</a></li><li class="is-active"><a class="tocitem" href>Spatial discretization</a><ul class="internal"><li><a class="tocitem" href="#Finite-volume-discretization-of-the-Navier-Stokes-equations"><span>Finite volume discretization of the Navier-Stokes equations</span></a></li><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li><li><a class="tocitem" href="#Fourth-order-accurate-discretization"><span>Fourth order accurate discretization</span></a></li><li><a class="tocitem" href="#Matrix-representation"><span>Matrix representation</span></a></li><li><a class="tocitem" href="#Discrete-pressure-Poisson-equation"><span>Discrete pressure Poisson equation</span></a></li><li><a class="tocitem" href="#Discrete-output-quantities"><span>Discrete output quantities</span></a></li><li><a class="tocitem" href="#Stream-function"><span>Stream function</span></a></li></ul></li><li><a class="tocitem" href="../time/">Time discretization</a></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../../features/bc/">Boundary conditions</a></li><li><a class="tocitem" href="../../features/pressure/">Pressure solvers</a></li><li><a class="tocitem" href="../../features/precision/">Floating point precision</a></li><li><a class="tocitem" href="../../features/gpu/">GPU Support</a></li><li><a class="tocitem" href="../../features/operators/">Operators</a></li><li><a class="tocitem" href="../../features/temperature/">Temperature equation</a></li><li><a class="tocitem" href="../../features/les/">Large eddy simulation</a></li><li><a class="tocitem" href="../../features/closure/">Neural closure models</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/api/">API</a></li><li><a class="tocitem" href="../../api/tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Equations</a></li><li class="is-active"><a href>Spatial discretization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spatial discretization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/equations/spatial.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Spatial-Discretization"><a class="docs-heading-anchor" href="#Spatial-Discretization">Spatial Discretization</a><a id="Spatial-Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-Discretization" title="Permalink"></a></h1><p>the <span>$d$</span> spatial dimensions are indexed by <span>$\alpha \in \{1, \dots, d\}$</span>. The <span>$\alpha$</span>-th unit vector is denoted <span>$e_\alpha = (e_{\alpha \beta})_{\beta = 1}^d$</span>, where the Kronecker symbol <span>$e_{\alpha \beta}$</span> is <span>$1$</span> if <span>$\alpha = \beta$</span> and <span>$0$</span> otherwise. We note <span>$h_\alpha = e_\alpha / 2$</span>. The Cartesian index <span>$I = (I_1, \dots, I_d)$</span> is used to avoid repeating terms and equations <span>$d$</span> times, where <span>$I_\alpha$</span> is a scalar index (typically one of <span>$i$</span>, <span>$j$</span>, and <span>$k$</span> in common notation). This notation is dimension-agnostic, since we can write <span>$u_I$</span> instead of <span>$u_{i j}$</span> in 2D or <span>$u_{i j k}$</span> in 3D. In our Julia implementation of the solver we use the same Cartesian notation (<code>u[I]</code> instead of <code>u[i, j]</code> or <code>u[i, j, k]</code>).</p><p>For the discretization scheme, we use a staggered Cartesian grid as proposed by Harlow and Welch [<a href="../../references/#Harlow1965">3</a>]. Consider a rectangular domain <span>$\Omega = \prod_{\alpha = 1}^d [a_\alpha, b_\alpha]$</span>, where <span>$a_\alpha &lt; b_\alpha$</span> are the domain boundaries and <span>$\prod$</span> is a Cartesian product. Let <span>$\Omega = \bigcup_{I \in \mathcal{I}} \Omega_I$</span> be a partitioning of <span>$\Omega$</span>, where <span>$\mathcal{I} = \prod_{\alpha = 1}^d \{ \frac{1}{2}, 2 - \frac{1}{2}, \dots, N_\alpha - \frac{1}{2} \}$</span> are volume center indices, <span>$N = (N_1, \dots, N_d) \in \mathbb{N}^d$</span> are the number of volumes in each dimension, <span>$\Omega_I = \prod_{\alpha = 1}^d \Delta^\alpha_{I_\alpha}$</span> is a finite volume, <span>$\Gamma^\alpha_I = \Omega_{I - h_\alpha} \cap \Omega_{I + h_\alpha} = \prod_{\beta \neq \alpha} \Delta^\beta_{I_\beta}$</span> is a volume face, <span>$\Delta^\alpha_i = \left[ x^\alpha_{i - \frac{1}{2}}, x^\alpha_{i + \frac{1}{2}} \right]$</span> is a volume edge, <span>$x^\alpha_0, \dots, x^\alpha_{N_\alpha}$</span> are volume boundary coordinates, and <span>$x^\alpha_i = \frac{1}{2} \left(x^\alpha_{i - \frac{1}{2}} + x^\alpha_{i + \frac{1}{2}}\right)$</span> for <span>$i \in \{ 1 / 2, \dots, N_\alpha - 1 / 2\}$</span> are volume center coordinates. We also define the operator <span>$\delta_\alpha$</span> which maps a discrete scalar field <span>$\varphi = (\varphi_I)_I$</span> to</p><p class="math-container">\[(\delta_\alpha \varphi)_I = \frac{\varphi_{I + h_\alpha} - \varphi_{I -
h_\alpha}}{| \Delta^\alpha_{I_\alpha} |}.\]</p><p>It can be interpreted as a discrete equivalent of the continuous operator <span>$\frac{\partial}{\partial x^\alpha}$</span>. All the above definitions are extended to be valid in volume centers <span>$I \in \mathcal{I}$</span>, volume faces <span>$I \in \mathcal{I} + h_\alpha$</span>, or volume corners <span>$I \in \mathcal{I} + \sum_{\alpha = 1}^d h_\alpha$</span>. The discretization is illustrated below:</p><p><img src="../../assets/grid.png" alt="Grid"/></p><h2 id="Finite-volume-discretization-of-the-Navier-Stokes-equations"><a class="docs-heading-anchor" href="#Finite-volume-discretization-of-the-Navier-Stokes-equations">Finite volume discretization of the Navier-Stokes equations</a><a id="Finite-volume-discretization-of-the-Navier-Stokes-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-volume-discretization-of-the-Navier-Stokes-equations" title="Permalink"></a></h2><p>We now define the unknown degrees of freedom. The average pressure in <span>$\Omega_I$</span>, <span>$I \in \mathcal{I}$</span> is approximated by the quantity <span>$p_I(t)$</span>. The average <span>$\alpha$</span>-velocity on the face <span>$\Gamma^\alpha_I$</span>, <span>$I \in \mathcal{I} + h_\alpha$</span> is approximated by the quantity <span>$u^\alpha_I(t)$</span>. Note how the pressure <span>$p$</span> and the <span>$d$</span> velocity fields <span>$u^\alpha$</span> are each defined in their own canonical positions <span>$x_I$</span> and <span>$x_{I + h_\alpha}$</span> for <span>$I \in \mathcal{I}$</span>. In the following, we derive equations for these unknowns.</p><p>Using the pressure control volume <span>$\mathcal{O} = \Omega_I$</span> with <span>$I \in \mathcal{I}$</span> in the mass integral constraint and approximating the face integrals with the mid-point quadrature rule <span>$\int_{\Gamma_I} u \, \mathrm{d} \Gamma \approx | \Gamma_I | u_I$</span> results in the discrete divergence-free constraint</p><p class="math-container">\[\sum_{\alpha = 1}^d (\delta_\alpha u^\alpha)_I = 0.\]</p><p>Note how dividing by the volume size results in a discrete equation resembling the continuous one (since <span>$| \Omega_I | = | \Gamma^\alpha_I | | \Delta^\alpha_{I_\alpha} |$</span>).</p><p>Similarly, choosing an <span>$\alpha$</span>-velocity control volume <span>$\mathcal{O} = \Omega_{I}$</span> with <span>$I \in \mathcal{I} + h_\alpha$</span> in the integral momentum equation, approximating the volume- and face integrals using the mid-point quadrature rule, and replacing remaining spatial derivatives in the diffusive term with a finite difference approximation gives the discrete momentum equations</p><p class="math-container">\[\frac{\mathrm{d}}{\mathrm{d} t} u^\alpha_{I} =
- \sum_{\beta = 1}^d
(\delta_\beta (u^\alpha u^\beta))_{I}
+ \nu \sum_{\beta = 1}^d
(\delta_\beta \delta_\beta u^\alpha)_{I}
+ f^\alpha(x_{I})
- (\delta_\alpha p)_{I}.\]</p><p>where we made the assumption that <span>$f$</span> is constant in time for simplicity. The outer discrete derivative in <span>$(\delta_\beta \delta_\beta u^\alpha)_{I}$</span> is required at the position <span>$I$</span>, which means that the inner derivative is evaluated as <span>$(\delta_\beta u^\alpha)_{I + h_\beta}$</span> and <span>$(\delta_\beta u^\alpha)_{I - h_\beta}$</span>, thus requiring <span>$u^\alpha_{I - 2 h_\beta}$</span>, <span>$u^\alpha_{I}$</span>, and <span>$u^\alpha_{I + 2 h_\beta}$</span>, which are all in their canonical positions. The two velocity components in the convective term <span>$u^\alpha u^\beta$</span> are required at the positions <span>$I - h_\beta$</span> and <span>$I + h_\beta$</span>, which are outside the canonical positions. Their value at the required position is obtained using averaging with weights <span>$1 / 2$</span> for the <span>$\alpha$</span>-component and with linear interpolation for the <span>$\beta$</span>-component. This preserves the skew-symmetry of the convection operator, such that energy is conserved (in the convective term) [<a href="../../references/#Verstappen2003">4</a>].</p><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Storage convention</header><div class="admonition-body"><p>We use the column-major convention (Julia, MATLAB, Fortran), and not the row-major convention (Python, C). Thus the <span>$x^1$</span>-index <span>$i$</span> will vary for one whole cycle in the vectors before the <span>$x^2$</span>-index <span>$j$</span>, <span>$x^3$</span> index <span>$k$</span>, and component-index <span>$\alpha$</span> are incremented, e.g. <span>$u_h = (u^1_{(1, 1, 1)}, u^1_{(2, 1, 1)}, \dots u^3_{(N_{u^3}(1), N_{u^3}(2), N_{u^3}(3))})$</span> in 3D.</p></div></div><h2 id="Fourth-order-accurate-discretization"><a class="docs-heading-anchor" href="#Fourth-order-accurate-discretization">Fourth order accurate discretization</a><a id="Fourth-order-accurate-discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Fourth-order-accurate-discretization" title="Permalink"></a></h2><p>The above discretization is second order accurate. A fourth order accurate discretization can be obtained by judiciously combining the second order discretization with itself on a grid with three times larger cells in each dimension [<a href="../../references/#Verstappen2003">4</a>] [<a href="../../references/#Sanderse2014">5</a>]. The coarse discretization is identical, but the mass equation is derived for the three times coarser control volume</p><p class="math-container">\[\Omega^3_I =
\bigcup_{\alpha = 1}^d \Omega_{I - e_\alpha} \cup
\Omega_I \cup \Omega_{I + e_\alpha},\]</p><p>while the momentum equation is derived for its shifted variant <span>$\Omega^3_{I + h_\alpha}$</span>. The resulting fourth order accurate equations are given by</p><p class="math-container">\[\sum_{\alpha = 1}^d
(\delta_\alpha u^\alpha)_I
-
\frac{| \Omega^3_I |}{3^{2 + d} | \Omega_I |}
\sum_{\alpha = 1}^d
(\delta^3_\alpha u^\alpha)_I
= 0\]</p><p>and</p><p class="math-container">\[\frac{\mathrm{d}}{\mathrm{d} t} u^\alpha_{I} =
- \sum_{\beta = 1}^d
(\delta_\beta (u^\alpha u^\beta))_{I}
+ \nu \sum_{\beta = 1}^d
(\delta_\beta \delta_\beta u^\alpha)_{I}
+ f^\alpha(x_{I})
- (\delta_\alpha p)_{I}
+ \text{fourth order},\]</p><p>where</p><p class="math-container">\[(\delta^3_\alpha \varphi)_I =
\frac{\varphi_{I + 3 h_\alpha} -
\varphi_{I - 3 h_\alpha}}{\Delta^\alpha_{I_\alpha - 1} +
\Delta^\alpha_{I_\alpha} + \Delta^\alpha_{I_\alpha + 1}}.\]</p><h2 id="Matrix-representation"><a class="docs-heading-anchor" href="#Matrix-representation">Matrix representation</a><a id="Matrix-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-representation" title="Permalink"></a></h2><p>We can write the mass and momentum equations in matrix form. We will use the same matrix notation for the second- and fourth order accurate discretizations. The discrete mass equation becomes</p><p class="math-container">\[M u_h + y_M = 0,\]</p><p>where <span>$M$</span> is the discrete divergence operator and <span>$y_M$</span> contains the boundary value contributions of the velocity to the divergence field.</p><p>The discrete momentum equations become</p><p class="math-container">\[\begin{split}
    \frac{\mathrm{d} u_h}{\mathrm{d} t} &amp; = -C(u_h) + \nu (D u_h +
    y_D) + f_h - (G p_h + y_G) \\
    &amp; = F(u_h) - (G p_h + y_G),
\end{split}\]</p><p>where <span>$C$</span> is she convection operator (including boundary contributions), <span>$D$</span> is the diffusion operator, <span>$y_D$</span> is boundary contribution to the diffusion term, <span>$G = W_u^{-1} M^\mathsf{T} W$</span> is the pressure gradient operator, <span>$y_G$</span> contains the boundary contribution of the pressure to the pressure gradient (only non-zero for pressure boundary conditions), <span>$W_u$</span> is a diagonal matrix containing the velocity volume sizes <span>$| \Omega_{I + \delta(\alpha) / 2} |$</span>, and <span>$W$</span> is a diagonal matrix containing the reference volume sizes <span>$| \Omega_I |$</span>. The term <span>$F$</span> refers to all the forces except for the pressure gradient.</p><div class="admonition is-info"><header class="admonition-header">Volume normalization</header><div class="admonition-body"><p>All the operators have been divided by the velocity volume sizes. As a result, the operators have the same units as their continuous counterparts.</p></div></div><h2 id="Discrete-pressure-Poisson-equation"><a class="docs-heading-anchor" href="#Discrete-pressure-Poisson-equation">Discrete pressure Poisson equation</a><a id="Discrete-pressure-Poisson-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-pressure-Poisson-equation" title="Permalink"></a></h2><p>Instead of directly discretizing the continuous pressure Poisson equation, we will rededuce it in the <em>discrete</em> setting, thus aiming to preserve the discrete divergence freeness instead of the continuous one. Applying the discrete divergence operator <span>$M$</span> to the discrete momentum equations yields the discrete pressure Poisson equation</p><p class="math-container">\[L p_h = W M (F(u_h) - y_G) + W \frac{\mathrm{d} y_M}{\mathrm{d} t},\]</p><p>where <span>$L = W M G = W M W_u^{-1} M^\mathsf{T} W$</span> is a discrete Laplace operator. It is positive symmetric.</p><div class="admonition is-info"><header class="admonition-header">Unsteady Dirichlet boundary conditions</header><div class="admonition-body"><p>If the equations are prescribed with unsteady Dirichlet boundary conditions, for example an inflow that varies with time, the term <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}$</span> will be non-zero. If this term is not known exactly, for example if the next value of the inflow is unknown at the time of the current value, it must be computed using past values of of the velocity inflow only, for example <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t} \approx (y_M(t) - y_M(t - \Delta t)) / \Delta t$</span> for some <span>$\Delta t$</span>.</p></div></div><div class="admonition is-info"><header class="admonition-header">Uniqueness of pressure field</header><div class="admonition-body"><p>Unless pressure boundary conditions are present, the pressure is only determined up to a constant, as <span>$L$</span> will have an eigenvalue of zero. Since only the gradient of the pressure appears in the equations, we can set the unknown constant to zero without affecting the velocity field.</p></div></div><div class="admonition is-info"><header class="admonition-header">Pressure projection</header><div class="admonition-body"><p>The pressure field <span>$p_h$</span> can be seen as a Lagrange multiplier enforcing the constraint of discrete divergence freeness. It is also possible to write the momentum equations without the pressure by explicitly solving the discrete Poisson equation:</p><p class="math-container">\[p_h = L^{-1} W M (F(u_h) - y_G) + L^{-1} W \frac{\mathrm{d} y_M}{\mathrm{d} t}.\]</p><p>The momentum equations then become</p><p class="math-container">\[\frac{\mathrm{d} u_h}{\mathrm{d} t} = (I - G L^{-1} W M)
(F(u_h) - y_G) - G L^{-1} W \frac{\mathrm{d} y_M}{\mathrm{d} t}.\]</p><p>The matrix <span>$(I - G L^{-1} W M)$</span> is a projector onto the space of discretely divergence free velocities. However, using this formulation would require an efficient way to perform the projection without assembling the operator matrix <span>$L^{-1}$</span>, which would be very costly.</p></div></div><h2 id="Discrete-output-quantities"><a class="docs-heading-anchor" href="#Discrete-output-quantities">Discrete output quantities</a><a id="Discrete-output-quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-output-quantities" title="Permalink"></a></h2><h3 id="Kinetic-energy"><a class="docs-heading-anchor" href="#Kinetic-energy">Kinetic energy</a><a id="Kinetic-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Kinetic-energy" title="Permalink"></a></h3><p>The local kinetic energy is defined by <span>$k = \frac{1}{2} \| u \|_2^2 = \frac{1}{2} \sum_{\alpha = 1}^d u^\alpha u^\alpha$</span>. On the staggered grid however, the different velocity components are not located at the same point. We will therefore interpolate the velocity to the pressure point before summing the squares.</p><h3 id="Vorticity"><a class="docs-heading-anchor" href="#Vorticity">Vorticity</a><a id="Vorticity-1"></a><a class="docs-heading-anchor-permalink" href="#Vorticity" title="Permalink"></a></h3><p>In 2D, the vorticity is a scalar. We define it as</p><p class="math-container">\[\omega = -\delta^2 u^1 + \delta^1 u^2.\]</p><p>The 3D vorticity is a vector field <span>$(\omega^1, \omega^2, \omega^3)$</span>. Noting <span>$\alpha^+ = \operatorname{mod}_3(\alpha + 1)$</span> and <span>$\alpha^- = \operatorname{mod}_3(\alpha - 1)$</span>, the vorticity is defined as through</p><p class="math-container">\[\omega^\alpha = - \delta^{\alpha^-} u^{\alpha^+} +
\delta^{\alpha^+} u^{\alpha^-}.\]</p><h2 id="Stream-function"><a class="docs-heading-anchor" href="#Stream-function">Stream function</a><a id="Stream-function-1"></a><a class="docs-heading-anchor-permalink" href="#Stream-function" title="Permalink"></a></h2><p>In 2D, the stream function is defined at the corners with the vorticity. Integrating the stream function Poisson equation over the vorticity volume yields</p><p class="math-container">\[\begin{split}
- \int_{\Omega_{I + h_1 + h_2}} \omega \, \mathrm{d} \Omega
&amp; = \int_{\Omega_{I + h_1 + h_2}} \nabla^2 \psi \,
\mathrm{d} \Omega \\
&amp; = \int_{\Gamma^1_{I + e_1 + h_2}} \frac{\partial \psi}{\partial x^1}
\, \mathrm{d} \Gamma
- \int_{\Gamma^1_{I + h_2}} \frac{\partial \psi}{\partial x^1}
\, \mathrm{d} \Gamma \\
&amp; + \int_{\Gamma^2_{I + h_1 + e_2}} \frac{\partial \psi}{\partial x^2}
\, \mathrm{d} \Gamma
- \int_{\Gamma^2_{I + h_1}} \frac{\partial \psi}{\partial x^2}
\, \mathrm{d} \Gamma.
\end{split}\]</p><p>Replacing the integrals with the mid-point quadrature rule and the spatial derivatives with central finite differences yields the discrete Poisson equation for the stream function at the vorticity point:</p><p class="math-container">\[\begin{split}
\left| \Gamma^1_{I + h_1 + h_2} \right|
\left(
  \frac{\psi_{I + 3 / h_1 + h_2} - \psi_{I + h_1 + h_2}}{x^1_{I_1 + 3 / 2} - x^1_{I_1 + 1 /2}}
- \frac{\psi_{I + h_1 + h_2} - \psi_{I - h_1 + h_2}}{x^1_{I_1 + 1 / 2} - x^1_{I_1 - 1 / 2}}
\right) &amp; + \\
\left| \Gamma^2_{I + h_1 + h_2} \right|
\left(
\frac{\psi_{I + h_1 + 3 h_2} - \psi_{I + h_1 + h_2}}{x^2_{I_1 + 3 / 2} - x^2_{I_1 + 1 / 2}}
-\frac{\psi_{I + h_1 + h_2} - \psi_{I + h_1 - h_2}}{x^2_{I_2 + 1 / 2} - x^2_{I_2 - 1 / 2}}
\right) &amp; = \\
\left| \Omega_{I + h_1 + h_2} \right|
\omega_{I + h_1 + h_2} &amp;
\end{split}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ns/">« Incompressible Navier-Stokes equations</a><a class="docs-footer-nextpage" href="../time/">Time discretization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Thursday 23 May 2024 19:26">Thursday 23 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
